<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-54780881-2"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'UA-54780881-2');
</script>
  
  
    <title>Chainer MNIST Model Deployment &#8212; seldon-core  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=83e35b93" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/rtd_sphinx_search.min.css?v=e72958e9" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css?v=15a8f09d" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/rtd_search_config.js?v=b0596c34"></script>
    <script src="../_static/js/rtd_sphinx_search.min.js?v=43f26ba4"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Custom pre-processors with the V2 protocol" href="transformers-v2-protocol.html" />
    <link rel="prev" title="Progressive Rollouts using Two Seldon Deployments" href="iter8-separate.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=teal>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#examples/chainer_mnist" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="seldon-core  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Seldon Core Documentation</span>
          <span class="md-header-nav__topic"> Chainer MNIST Model Deployment </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/SeldonIO/seldon-core/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Seldon Core
  </div>
</a>
          </div>
        </div>
      
      
    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="/" class="md-tabs__link">🚀 Our Other Projects & Products:</a></li>
            
            <li class="md-tabs__item"><a href="https://docs.seldon.io/projects/alibi/en/stable/" class="md-tabs__link">Alibi Explain</a></li>
            
            <li class="md-tabs__item"><a href="https://docs.seldon.io/projects/alibi-detect/en/stable/" class="md-tabs__link">Alibi Detect</a></li>
            
            <li class="md-tabs__item"><a href="https://mlserver.readthedocs.io/en/latest/" class="md-tabs__link">MLServer</a></li>
            
            <li class="md-tabs__item"><a href="https://tempo.readthedocs.io/en/latest/" class="md-tabs__link">Tempo SDK</a></li>
            
            <li class="md-tabs__item"><a href="https://deploy.seldon.io" class="md-tabs__link">Seldon Enterprise Platform</a></li>
            
            <li class="md-tabs__item"><a href="https://github.com/SeldonIO/seldon-deploy-sdk#seldon-deploy-sdk" class="md-tabs__link">Seldon Enterprise Platform SDK</a></li>
          <li class="md-tabs__item"><a href="../nav/tutorials.html" class="md-tabs__link">教程</a></li>
          <li class="md-tabs__item"><a href="notebooks.html" class="md-tabs__link">笔记本</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="seldon-core documentation" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="seldon-core documentation">Seldon Core Documentation</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/SeldonIO/seldon-core/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Seldon Core
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../nav/getting-started.html" class="md-nav__link">开始</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../nav/concepts.html" class="md-nav__link">概念</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../nav/configuration.html" class="md-nav__link">配置</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../nav/tutorials.html" class="md-nav__link">教程</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="notebooks.html" class="md-nav__link">笔记本</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#seldon-core" class="md-nav__link">Seldon Core 设置</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#id2" class="md-nav__link">预包装推理服务示例</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#python" class="md-nav__link">Python 语言封装示例</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#id3" class="md-nav__link">专门的框架示例</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#id4" class="md-nav__link">孵化项目示例</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#id5" class="md-nav__link">基于云的基础示例</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#id6" class="md-nav__link">高级机器学习监控</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#id7" class="md-nav__link">Seldon Core 批处理</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#mlops" class="md-nav__link">MLOps: 扩展、监控和可观察性</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#id8" class="md-nav__link">生产配置及实现</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#ab" class="md-nav__link">AB 测试及渐进式部署</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#id9" class="md-nav__link">复杂图示例</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#id10" class="md-nav__link">入口</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#id11" class="md-nav__link">基础设施</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#id12" class="md-nav__link">基准测试和负载测试</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notebooks.html#id13" class="md-nav__link">升级示例</a>
      
    
    </li></ul>
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../nav/reference.html" class="md-nav__link">参考</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../nav/contributing.html" class="md-nav__link">贡献</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-chainer-mnist--page-root" class="md-nav__link">Chainer MNIST Model Deployment</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Dependencies" class="md-nav__link">Dependencies</a>
        </li>
        <li class="md-nav__item"><a href="#Train-locally" class="md-nav__link">Train locally</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Test-using-Minikube" class="md-nav__link">Test using Minikube</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Setup-Seldon-Core" class="md-nav__link">Setup Seldon Core</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/examples/chainer_mnist.nblink.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <div class="admonition note">
<p>This page was generated from <a class="reference external" href="https://github.com/SeldonIO/seldon-core/blob/e665e4994eabf83fb43c68a5f85e96d5c45e91b5/examples/models/chainer_mnist/chainer_mnist.ipynb">examples/models/chainer_mnist/chainer_mnist.ipynb</a>.</p>
</div>
<section id="Chainer-MNIST-Model-Deployment">
<h1 id="examples-chainer-mnist--page-root">Chainer MNIST Model Deployment<a class="headerlink" href="#examples-chainer-mnist--page-root" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p>Wrap a Chainer MNIST python model for use as a prediction microservice in seldon-core</p>
<ul>
<li><p>Run locally on Docker to test</p></li>
<li><p>Deploy on seldon-core running on minikube</p></li>
</ul>
</li>
</ul>
<section id="Dependencies">
<h2 id="Dependencies">Dependencies<a class="headerlink" href="#Dependencies" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/kubernetes/helm">Helm</a></p></li>
<li><p><a class="reference external" href="https://github.com/kubernetes/minikube">Minikube</a></p></li>
<li><p><a class="reference external" href="https://github.com/openshift/source-to-image">S2I</a></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>seldon-core
pip<span class="w"> </span>install<span class="w"> </span><span class="nv">chainer</span><span class="o">==</span><span class="m">6</span>.2.0
</pre></div>
</div>
</section>
<section id="Train-locally">
<h2 id="Train-locally">Train locally<a class="headerlink" href="#Train-locally" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">argparse</span>

<span class="kn">import</span> <span class="nn">chainer</span>
<span class="kn">import</span> <span class="nn">chainer.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">chainer.links</span> <span class="k">as</span> <span class="nn">L</span>
<span class="kn">import</span> <span class="nn">chainerx</span>
<span class="kn">from</span> <span class="nn">chainer</span> <span class="kn">import</span> <span class="n">training</span>
<span class="kn">from</span> <span class="nn">chainer.training</span> <span class="kn">import</span> <span class="n">extensions</span>


<span class="c1"># Network definition</span>
<span class="k">class</span> <span class="nc">MLP</span><span class="p">(</span><span class="n">chainer</span><span class="o">.</span><span class="n">Chain</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_units</span><span class="p">,</span> <span class="n">n_out</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MLP</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_scope</span><span class="p">():</span>
            <span class="c1"># the size of the inputs to each layer will be inferred</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_units</span><span class="p">)</span>  <span class="c1"># n_in -&gt; n_units</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">l2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_units</span><span class="p">)</span>  <span class="c1"># n_units -&gt; n_units</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">l3</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_out</span><span class="p">)</span>  <span class="c1"># n_units -&gt; n_out</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">h1</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">h2</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l2</span><span class="p">(</span><span class="n">h1</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">l3</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Chainer example: MNIST"</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">"--batchsize"</span><span class="p">,</span>
        <span class="s2">"-b"</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">"Number of images in each mini-batch"</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">"--epoch"</span><span class="p">,</span>
        <span class="s2">"-e"</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">"Number of sweeps over the dataset to train"</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">"--frequency"</span><span class="p">,</span> <span class="s2">"-f"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">"Frequency of taking a snapshot"</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">"--device"</span><span class="p">,</span>
        <span class="s2">"-d"</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">"-1"</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">"Device specifier. Either ChainerX device "</span>
        <span class="s2">"specifier or an integer. If non-negative integer, "</span>
        <span class="s2">"CuPy arrays with specified device id are used. If "</span>
        <span class="s2">"negative integer, NumPy arrays are used"</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">"--out"</span><span class="p">,</span> <span class="s2">"-o"</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">"result"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">"Directory to output the result"</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">"--resume"</span><span class="p">,</span> <span class="s2">"-r"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">"Resume the training from snapshot"</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">"--unit"</span><span class="p">,</span> <span class="s2">"-u"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">"Number of units"</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">"--noplot"</span><span class="p">,</span>
        <span class="n">dest</span><span class="o">=</span><span class="s2">"plot"</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s2">"store_false"</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">"Disable PlotReport extension"</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">group</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">"deprecated arguments"</span><span class="p">)</span>
    <span class="n">group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">"--gpu"</span><span class="p">,</span>
        <span class="s2">"-g"</span><span class="p">,</span>
        <span class="n">dest</span><span class="o">=</span><span class="s2">"device"</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">"?"</span><span class="p">,</span>
        <span class="n">const</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">"GPU ID (negative value indicates CPU)"</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[])</span>

    <span class="n">device</span> <span class="o">=</span> <span class="n">chainer</span><span class="o">.</span><span class="n">get_device</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"Device: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">device</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"# unit: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"# Minibatch-size: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">batchsize</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"# epoch: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">epoch</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

    <span class="c1"># Set up a neural network to train</span>
    <span class="c1"># Classifier reports softmax cross entropy loss and accuracy at every</span>
    <span class="c1"># iteration, which will be used by the PrintReport extension below.</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">Classifier</span><span class="p">(</span><span class="n">MLP</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">to_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">device</span><span class="o">.</span><span class="n">use</span><span class="p">()</span>

    <span class="c1"># Setup an optimizer</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">chainer</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="c1"># Load the MNIST dataset</span>
    <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">chainer</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_mnist</span><span class="p">()</span>

    <span class="n">train_iter</span> <span class="o">=</span> <span class="n">chainer</span><span class="o">.</span><span class="n">iterators</span><span class="o">.</span><span class="n">SerialIterator</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">batchsize</span><span class="p">)</span>
    <span class="n">test_iter</span> <span class="o">=</span> <span class="n">chainer</span><span class="o">.</span><span class="n">iterators</span><span class="o">.</span><span class="n">SerialIterator</span><span class="p">(</span>
        <span class="n">test</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">batchsize</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="c1"># Set up a trainer</span>
    <span class="n">updater</span> <span class="o">=</span> <span class="n">training</span><span class="o">.</span><span class="n">updaters</span><span class="o">.</span><span class="n">StandardUpdater</span><span class="p">(</span><span class="n">train_iter</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
    <span class="n">trainer</span> <span class="o">=</span> <span class="n">training</span><span class="o">.</span><span class="n">Trainer</span><span class="p">(</span><span class="n">updater</span><span class="p">,</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">epoch</span><span class="p">,</span> <span class="s2">"epoch"</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">out</span><span class="p">)</span>

    <span class="c1"># Evaluate the model with the test dataset for each epoch</span>
    <span class="n">trainer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extensions</span><span class="o">.</span><span class="n">Evaluator</span><span class="p">(</span><span class="n">test_iter</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>

    <span class="c1"># Dump a computational graph from 'loss' variable at the first iteration</span>
    <span class="c1"># The "main" refers to the target link of the "main" optimizer.</span>
    <span class="c1"># TODO(niboshi): Temporarily disabled for chainerx. Fix it.</span>
    <span class="k">if</span> <span class="n">device</span><span class="o">.</span><span class="n">xp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">chainerx</span><span class="p">:</span>
        <span class="n">trainer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extensions</span><span class="o">.</span><span class="n">DumpGraph</span><span class="p">(</span><span class="s2">"main/loss"</span><span class="p">))</span>

    <span class="c1"># Take a snapshot for each specified epoch</span>
    <span class="n">frequency</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">epoch</span> <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">frequency</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">frequency</span><span class="p">)</span>
    <span class="n">trainer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extensions</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(),</span> <span class="n">trigger</span><span class="o">=</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="s2">"epoch"</span><span class="p">))</span>

    <span class="c1"># Write a log of evaluation statistics for each epoch</span>
    <span class="n">trainer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extensions</span><span class="o">.</span><span class="n">LogReport</span><span class="p">())</span>

    <span class="c1"># Save two plot images to the result dir</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">plot</span> <span class="ow">and</span> <span class="n">extensions</span><span class="o">.</span><span class="n">PlotReport</span><span class="o">.</span><span class="n">available</span><span class="p">():</span>
        <span class="n">trainer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="n">extensions</span><span class="o">.</span><span class="n">PlotReport</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">"main/loss"</span><span class="p">,</span> <span class="s2">"validation/main/loss"</span><span class="p">],</span> <span class="s2">"epoch"</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"loss.png"</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">trainer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="n">extensions</span><span class="o">.</span><span class="n">PlotReport</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">"main/accuracy"</span><span class="p">,</span> <span class="s2">"validation/main/accuracy"</span><span class="p">],</span>
                <span class="s2">"epoch"</span><span class="p">,</span>
                <span class="n">file_name</span><span class="o">=</span><span class="s2">"accuracy.png"</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># Print selected entries of the log to stdout</span>
    <span class="c1"># Here "main" refers to the target link of the "main" optimizer again, and</span>
    <span class="c1"># "validation" refers to the default name of the Evaluator extension.</span>
    <span class="c1"># Entries other than 'epoch' are reported by the Classifier link, called by</span>
    <span class="c1"># either the updater or the evaluator.</span>
    <span class="n">trainer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
        <span class="n">extensions</span><span class="o">.</span><span class="n">PrintReport</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">"epoch"</span><span class="p">,</span>
                <span class="s2">"main/loss"</span><span class="p">,</span>
                <span class="s2">"validation/main/loss"</span><span class="p">,</span>
                <span class="s2">"main/accuracy"</span><span class="p">,</span>
                <span class="s2">"validation/main/accuracy"</span><span class="p">,</span>
                <span class="s2">"elapsed_time"</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Print a progress bar to stdout</span>
    <span class="n">trainer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extensions</span><span class="o">.</span><span class="n">ProgressBar</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">resume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Resume from a snapshot</span>
        <span class="n">chainer</span><span class="o">.</span><span class="n">serializers</span><span class="o">.</span><span class="n">load_npz</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">resume</span><span class="p">,</span> <span class="n">trainer</span><span class="p">)</span>

    <span class="c1"># Run the training</span>
    <span class="n">trainer</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/chainer/_environment_check.py:41: UserWarning: Accelerate has been detected as a NumPy backend library.
vecLib, which is a part of Accelerate, is known not to work correctly with Chainer.
We recommend using other BLAS libraries such as OpenBLAS.
For details of the issue, please see
https://docs.chainer.org/en/stable/tips.html#mnist-example-does-not-converge-in-cpu-mode-on-mac-os-x.

Please be aware that Mac OS X is not an officially supported OS.

  ''')  # NOQA
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Device: @numpy
# unit: 1000
# Minibatch-size: 100
# epoch: 20

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/chainer/training/extensions/plot_report.py:32: UserWarning: matplotlib is not installed on your environment, so nothing will be plotted at this time. Please install matplotlib to plot figures.

  $ pip install matplotlib

  warnings.warn('matplotlib is not installed on your environment, '
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
epoch       main/loss   validation/main/loss  main/accuracy  validation/main/accuracy  elapsed_time
     total [..................................................]  0.83%
this epoch [########..........................................] 16.67%
       100 iter, 0 epoch / 20 epochs
       inf iters/sec. Estimated time to finish: 0:00:00.
     total [..................................................]  1.67%
this epoch [################..................................] 33.33%
       200 iter, 0 epoch / 20 epochs
    43.916 iters/sec. Estimated time to finish: 0:04:28.695672.
     total [#.................................................]  2.50%
this epoch [#########################.........................] 50.00%
       300 iter, 0 epoch / 20 epochs
    45.431 iters/sec. Estimated time to finish: 0:04:17.534906.
     total [#.................................................]  3.33%
this epoch [#################################.................] 66.67%
       400 iter, 0 epoch / 20 epochs
    44.796 iters/sec. Estimated time to finish: 0:04:18.950502.
     total [##................................................]  4.17%
this epoch [#########################################.........] 83.33%
       500 iter, 0 epoch / 20 epochs
    44.363 iters/sec. Estimated time to finish: 0:04:19.224978.
1           0.191134    0.104015              0.942833       0.9664                    14.3463
     total [##................................................]  5.00%
this epoch [..................................................]  0.00%
       600 iter, 1 epoch / 20 epochs
    41.815 iters/sec. Estimated time to finish: 0:04:32.630750.
     total [##................................................]  5.83%
this epoch [########..........................................] 16.67%
       700 iter, 1 epoch / 20 epochs
     41.68 iters/sec. Estimated time to finish: 0:04:31.113255.
     total [###...............................................]  6.67%
this epoch [################..................................] 33.33%
       800 iter, 1 epoch / 20 epochs
    41.313 iters/sec. Estimated time to finish: 0:04:31.103168.
     total [###...............................................]  7.50%
this epoch [#########################.........................] 50.00%
       900 iter, 1 epoch / 20 epochs
    40.762 iters/sec. Estimated time to finish: 0:04:32.314401.
     total [####..............................................]  8.33%
this epoch [#################################.................] 66.67%
      1000 iter, 1 epoch / 20 epochs
    40.337 iters/sec. Estimated time to finish: 0:04:32.701110.
     total [####..............................................]  9.17%
this epoch [#########################################.........] 83.33%
      1100 iter, 1 epoch / 20 epochs
    40.131 iters/sec. Estimated time to finish: 0:04:31.609394.
2           0.0770754   0.0721484             0.9757         0.9764                    30.3365
     total [#####.............................................] 10.00%
this epoch [..................................................]  0.00%
      1200 iter, 2 epoch / 20 epochs
    39.361 iters/sec. Estimated time to finish: 0:04:34.386204.
     total [#####.............................................] 10.83%
this epoch [########..........................................] 16.67%
      1300 iter, 2 epoch / 20 epochs
     38.88 iters/sec. Estimated time to finish: 0:04:35.203848.
     total [#####.............................................] 11.67%
this epoch [################..................................] 33.33%
      1400 iter, 2 epoch / 20 epochs
    38.471 iters/sec. Estimated time to finish: 0:04:35.534012.
     total [######............................................] 12.50%
this epoch [#########################.........................] 50.00%
      1500 iter, 2 epoch / 20 epochs
    38.217 iters/sec. Estimated time to finish: 0:04:34.750417.
     total [######............................................] 13.33%
this epoch [#################################.................] 66.67%
      1600 iter, 2 epoch / 20 epochs
    38.206 iters/sec. Estimated time to finish: 0:04:32.210044.
     total [#######...........................................] 14.17%
this epoch [#########################################.........] 83.33%
      1700 iter, 2 epoch / 20 epochs
     38.03 iters/sec. Estimated time to finish: 0:04:30.836325.
3           0.0491765   0.0686589             0.984117       0.9783                    47.5777
     total [#######...........................................] 15.00%
this epoch [..................................................]  0.00%
      1800 iter, 3 epoch / 20 epochs
    37.621 iters/sec. Estimated time to finish: 0:04:31.123488.
     total [#######...........................................] 15.83%
this epoch [########..........................................] 16.67%
      1900 iter, 3 epoch / 20 epochs
    37.486 iters/sec. Estimated time to finish: 0:04:29.434877.
     total [########..........................................] 16.67%
this epoch [################..................................] 33.33%
      2000 iter, 3 epoch / 20 epochs
    37.124 iters/sec. Estimated time to finish: 0:04:29.367115.
     total [########..........................................] 17.50%
this epoch [#########################.........................] 50.00%
      2100 iter, 3 epoch / 20 epochs
    36.981 iters/sec. Estimated time to finish: 0:04:27.702144.
     total [#########.........................................] 18.33%
this epoch [#################################.................] 66.67%
      2200 iter, 3 epoch / 20 epochs
    36.893 iters/sec. Estimated time to finish: 0:04:25.632841.
     total [#########.........................................] 19.17%
this epoch [#########################################.........] 83.33%
      2300 iter, 3 epoch / 20 epochs
    36.626 iters/sec. Estimated time to finish: 0:04:24.839007.
4           0.0344382   0.0732416             0.988733       0.9793                    66.0447
     total [##########........................................] 20.00%
this epoch [..................................................]  0.00%
      2400 iter, 4 epoch / 20 epochs
    36.133 iters/sec. Estimated time to finish: 0:04:25.687154.
     total [##########........................................] 20.83%
this epoch [########..........................................] 16.67%
      2500 iter, 4 epoch / 20 epochs
    36.036 iters/sec. Estimated time to finish: 0:04:23.627129.
     total [##########........................................] 21.67%
this epoch [################..................................] 33.33%
      2600 iter, 4 epoch / 20 epochs
    35.894 iters/sec. Estimated time to finish: 0:04:21.883252.
     total [###########.......................................] 22.50%
this epoch [#########################.........................] 50.00%
      2700 iter, 4 epoch / 20 epochs
    35.863 iters/sec. Estimated time to finish: 0:04:19.317012.
     total [###########.......................................] 23.33%
this epoch [#################################.................] 66.67%
      2800 iter, 4 epoch / 20 epochs
    35.882 iters/sec. Estimated time to finish: 0:04:16.399349.
     total [############......................................] 24.17%
this epoch [#########################################.........] 83.33%
      2900 iter, 4 epoch / 20 epochs
    35.858 iters/sec. Estimated time to finish: 0:04:13.775733.
5           0.0280074   0.0716412             0.990383       0.9804                    83.6667
     total [############......................................] 25.00%
this epoch [..................................................]  0.00%
      3000 iter, 5 epoch / 20 epochs
    35.681 iters/sec. Estimated time to finish: 0:04:12.234897.
     total [############......................................] 25.83%
this epoch [########..........................................] 16.67%
      3100 iter, 5 epoch / 20 epochs
    35.678 iters/sec. Estimated time to finish: 0:04:09.451360.
     total [#############.....................................] 26.67%
this epoch [################..................................] 33.33%
      3200 iter, 5 epoch / 20 epochs
    35.648 iters/sec. Estimated time to finish: 0:04:06.858238.
     total [#############.....................................] 27.50%
this epoch [#########################.........................] 50.00%
      3300 iter, 5 epoch / 20 epochs
    35.646 iters/sec. Estimated time to finish: 0:04:04.067962.
     total [##############....................................] 28.33%
this epoch [#################################.................] 66.67%
      3400 iter, 5 epoch / 20 epochs
     35.62 iters/sec. Estimated time to finish: 0:04:01.439835.
     total [##############....................................] 29.17%
this epoch [#########################################.........] 83.33%
      3500 iter, 5 epoch / 20 epochs
    35.548 iters/sec. Estimated time to finish: 0:03:59.114360.
6           0.0221732   0.0800123             0.992683       0.9783                    101.278
     total [###############...................................] 30.00%
this epoch [..................................................]  0.00%
      3600 iter, 6 epoch / 20 epochs
    35.394 iters/sec. Estimated time to finish: 0:03:57.328954.
     total [###############...................................] 30.83%
this epoch [########..........................................] 16.67%
      3700 iter, 6 epoch / 20 epochs
    35.101 iters/sec. Estimated time to finish: 0:03:56.458370.
     total [###############...................................] 31.67%
this epoch [################..................................] 33.33%
      3800 iter, 6 epoch / 20 epochs
    35.097 iters/sec. Estimated time to finish: 0:03:53.638225.
     total [################..................................] 32.50%
this epoch [#########################.........................] 50.00%
      3900 iter, 6 epoch / 20 epochs
     35.08 iters/sec. Estimated time to finish: 0:03:50.901687.
     total [################..................................] 33.33%
this epoch [#################################.................] 66.67%
      4000 iter, 6 epoch / 20 epochs
    35.062 iters/sec. Estimated time to finish: 0:03:48.167167.
     total [#################.................................] 34.17%
this epoch [#########################################.........] 83.33%
      4100 iter, 6 epoch / 20 epochs
    35.035 iters/sec. Estimated time to finish: 0:03:45.491051.
7           0.0197829   0.0768317             0.9938         0.9784                    119.732
     total [#################.................................] 35.00%
this epoch [..................................................]  0.00%
      4200 iter, 7 epoch / 20 epochs
    34.941 iters/sec. Estimated time to finish: 0:03:43.233173.
     total [#################.................................] 35.83%
this epoch [########..........................................] 16.67%
      4300 iter, 7 epoch / 20 epochs
    34.943 iters/sec. Estimated time to finish: 0:03:40.358854.
     total [##################................................] 36.67%
this epoch [################..................................] 33.33%
      4400 iter, 7 epoch / 20 epochs
    34.939 iters/sec. Estimated time to finish: 0:03:37.521260.
     total [##################................................] 37.50%
this epoch [#########################.........................] 50.00%
      4500 iter, 7 epoch / 20 epochs
    34.942 iters/sec. Estimated time to finish: 0:03:34.640363.
     total [###################...............................] 38.33%
this epoch [#################################.................] 66.67%
      4600 iter, 7 epoch / 20 epochs
    34.936 iters/sec. Estimated time to finish: 0:03:31.816158.
     total [###################...............................] 39.17%
this epoch [#########################################.........] 83.33%
      4700 iter, 7 epoch / 20 epochs
    34.921 iters/sec. Estimated time to finish: 0:03:29.044796.
8           0.016657    0.113716              0.994683       0.9749                    137.569
     total [####################..............................] 40.00%
this epoch [..................................................]  0.00%
      4800 iter, 8 epoch / 20 epochs
    34.769 iters/sec. Estimated time to finish: 0:03:27.079825.
     total [####################..............................] 40.83%
this epoch [########..........................................] 16.67%
      4900 iter, 8 epoch / 20 epochs
    34.729 iters/sec. Estimated time to finish: 0:03:24.437863.
     total [####################..............................] 41.67%
this epoch [################..................................] 33.33%
      5000 iter, 8 epoch / 20 epochs
     34.73 iters/sec. Estimated time to finish: 0:03:21.554960.
     total [#####################.............................] 42.50%
this epoch [#########################.........................] 50.00%
      5100 iter, 8 epoch / 20 epochs
    34.724 iters/sec. Estimated time to finish: 0:03:18.709996.
     total [#####################.............................] 43.33%
this epoch [#################################.................] 66.67%
      5200 iter, 8 epoch / 20 epochs
    34.723 iters/sec. Estimated time to finish: 0:03:15.835849.
     total [######################............................] 44.17%
this epoch [#########################################.........] 83.33%
      5300 iter, 8 epoch / 20 epochs
    34.715 iters/sec. Estimated time to finish: 0:03:13.000289.
9           0.0196976   0.0879474             0.993633       0.9807                    155.458
     total [######################............................] 45.00%
this epoch [..................................................]  0.00%
      5400 iter, 9 epoch / 20 epochs
    34.626 iters/sec. Estimated time to finish: 0:03:10.610652.
     total [######################............................] 45.83%
this epoch [########..........................................] 16.67%
      5500 iter, 9 epoch / 20 epochs
      34.6 iters/sec. Estimated time to finish: 0:03:07.863616.
     total [#######################...........................] 46.67%
this epoch [################..................................] 33.33%
      5600 iter, 9 epoch / 20 epochs
    34.582 iters/sec. Estimated time to finish: 0:03:05.066867.
     total [#######################...........................] 47.50%
this epoch [#########################.........................] 50.00%
      5700 iter, 9 epoch / 20 epochs
     34.56 iters/sec. Estimated time to finish: 0:03:02.289066.
     total [########################..........................] 48.33%
this epoch [#################################.................] 66.67%
      5800 iter, 9 epoch / 20 epochs
    34.524 iters/sec. Estimated time to finish: 0:02:59.585753.
     total [########################..........................] 49.17%
this epoch [#########################################.........] 83.33%
      5900 iter, 9 epoch / 20 epochs
    34.479 iters/sec. Estimated time to finish: 0:02:56.921205.
10          0.0135036   0.094506              0.9956         0.9788                    174.195
     total [#########################.........................] 50.00%
this epoch [..................................................]  0.00%
      6000 iter, 10 epoch / 20 epochs
    34.342 iters/sec. Estimated time to finish: 0:02:54.714546.
     total [#########################.........................] 50.83%
this epoch [########..........................................] 16.67%
      6100 iter, 10 epoch / 20 epochs
    34.293 iters/sec. Estimated time to finish: 0:02:52.047114.
     total [#########################.........................] 51.67%
this epoch [################..................................] 33.33%
      6200 iter, 10 epoch / 20 epochs
    34.267 iters/sec. Estimated time to finish: 0:02:49.260471.
     total [##########################........................] 52.50%
this epoch [#########################.........................] 50.00%
      6300 iter, 10 epoch / 20 epochs
    34.226 iters/sec. Estimated time to finish: 0:02:46.539137.
     total [##########################........................] 53.33%
this epoch [#################################.................] 66.67%
      6400 iter, 10 epoch / 20 epochs
    34.194 iters/sec. Estimated time to finish: 0:02:43.773183.
     total [###########################.......................] 54.17%
this epoch [#########################################.........] 83.33%
      6500 iter, 10 epoch / 20 epochs
    34.149 iters/sec. Estimated time to finish: 0:02:41.057623.
11          0.0174658   0.118295              0.9947         0.9766                    193.345
     total [###########################.......................] 55.00%
this epoch [..................................................]  0.00%
      6600 iter, 11 epoch / 20 epochs
     34.04 iters/sec. Estimated time to finish: 0:02:38.637333.
     total [###########################.......................] 55.83%
this epoch [########..........................................] 16.67%
      6700 iter, 11 epoch / 20 epochs
    33.997 iters/sec. Estimated time to finish: 0:02:35.894480.
     total [############################......................] 56.67%
this epoch [################..................................] 33.33%
      6800 iter, 11 epoch / 20 epochs
    33.929 iters/sec. Estimated time to finish: 0:02:33.260000.
     total [############################......................] 57.50%
this epoch [#########################.........................] 50.00%
      6900 iter, 11 epoch / 20 epochs
    33.885 iters/sec. Estimated time to finish: 0:02:30.506863.
     total [#############################.....................] 58.33%
this epoch [#################################.................] 66.67%
      7000 iter, 11 epoch / 20 epochs
    33.848 iters/sec. Estimated time to finish: 0:02:27.717927.
     total [#############################.....................] 59.17%
this epoch [#########################################.........] 83.33%
      7100 iter, 11 epoch / 20 epochs
    33.798 iters/sec. Estimated time to finish: 0:02:24.978252.
12          0.0110422   0.092281              0.996467       0.9804                    213.149
     total [##############################....................] 60.00%
this epoch [..................................................]  0.00%
      7200 iter, 12 epoch / 20 epochs
    33.688 iters/sec. Estimated time to finish: 0:02:22.482880.
     total [##############################....................] 60.83%
this epoch [########..........................................] 16.67%
      7300 iter, 12 epoch / 20 epochs
    33.627 iters/sec. Estimated time to finish: 0:02:19.767865.
     total [##############################....................] 61.67%
this epoch [################..................................] 33.33%
      7400 iter, 12 epoch / 20 epochs
     33.57 iters/sec. Estimated time to finish: 0:02:17.027452.
     total [###############################...................] 62.50%
this epoch [#########################.........................] 50.00%
      7500 iter, 12 epoch / 20 epochs
    33.454 iters/sec. Estimated time to finish: 0:02:14.514958.
     total [###############################...................] 63.33%
this epoch [#################################.................] 66.67%
      7600 iter, 12 epoch / 20 epochs
    33.404 iters/sec. Estimated time to finish: 0:02:11.721757.
     total [################################..................] 64.17%
this epoch [#########################################.........] 83.33%
      7700 iter, 12 epoch / 20 epochs
    33.361 iters/sec. Estimated time to finish: 0:02:08.892462.
13          0.0131023   0.112165              0.996183       0.9795                    233.983
     total [################################..................] 65.00%
this epoch [..................................................]  0.00%
      7800 iter, 13 epoch / 20 epochs
    33.249 iters/sec. Estimated time to finish: 0:02:06.321430.
     total [################################..................] 65.83%
this epoch [########..........................................] 16.67%
      7900 iter, 13 epoch / 20 epochs
    33.197 iters/sec. Estimated time to finish: 0:02:03.506134.
     total [#################################.................] 66.67%
this epoch [################..................................] 33.33%
      8000 iter, 13 epoch / 20 epochs
    33.148 iters/sec. Estimated time to finish: 0:02:00.671093.
     total [#################################.................] 67.50%
this epoch [#########################.........................] 50.00%
      8100 iter, 13 epoch / 20 epochs
    33.099 iters/sec. Estimated time to finish: 0:01:57.829645.
     total [##################################................] 68.33%
this epoch [#################################.................] 66.67%
      8200 iter, 13 epoch / 20 epochs
    33.044 iters/sec. Estimated time to finish: 0:01:54.999835.
     total [##################################................] 69.17%
this epoch [#########################################.........] 83.33%
      8300 iter, 13 epoch / 20 epochs
    32.925 iters/sec. Estimated time to finish: 0:01:52.378181.
14          0.0107402   0.106344              0.99645        0.9813                    255.572
     total [###################################...............] 70.00%
this epoch [..................................................]  0.00%
      8400 iter, 14 epoch / 20 epochs
    32.783 iters/sec. Estimated time to finish: 0:01:49.812125.
     total [###################################...............] 70.83%
this epoch [########..........................................] 16.67%
      8500 iter, 14 epoch / 20 epochs
    32.686 iters/sec. Estimated time to finish: 0:01:47.081025.
     total [###################################...............] 71.67%
this epoch [################..................................] 33.33%
      8600 iter, 14 epoch / 20 epochs
    32.641 iters/sec. Estimated time to finish: 0:01:44.163313.
     total [####################################..............] 72.50%
this epoch [#########################.........................] 50.00%
      8700 iter, 14 epoch / 20 epochs
    32.589 iters/sec. Estimated time to finish: 0:01:41.262226.
     total [####################################..............] 73.33%
this epoch [#################################.................] 66.67%
      8800 iter, 14 epoch / 20 epochs
    32.542 iters/sec. Estimated time to finish: 0:01:38.335180.
     total [#####################################.............] 74.17%
this epoch [#########################################.........] 83.33%
      8900 iter, 14 epoch / 20 epochs
    32.489 iters/sec. Estimated time to finish: 0:01:35.416948.
15          0.0125309   0.0853632             0.996467       0.9835                    277.066
     total [#####################################.............] 75.00%
this epoch [..................................................]  0.00%
      9000 iter, 15 epoch / 20 epochs
    32.402 iters/sec. Estimated time to finish: 0:01:32.586512.
     total [#####################################.............] 75.83%
this epoch [########..........................................] 16.67%
      9100 iter, 15 epoch / 20 epochs
    32.348 iters/sec. Estimated time to finish: 0:01:29.649633.
     total [######################################............] 76.67%
this epoch [################..................................] 33.33%
      9200 iter, 15 epoch / 20 epochs
    32.302 iters/sec. Estimated time to finish: 0:01:26.683121.
     total [######################################............] 77.50%
this epoch [#########################.........................] 50.00%
      9300 iter, 15 epoch / 20 epochs
    32.247 iters/sec. Estimated time to finish: 0:01:23.728150.
     total [#######################################...........] 78.33%
this epoch [#################################.................] 66.67%
      9400 iter, 15 epoch / 20 epochs
    32.181 iters/sec. Estimated time to finish: 0:01:20.793071.
     total [#######################################...........] 79.17%
this epoch [#########################################.........] 83.33%
      9500 iter, 15 epoch / 20 epochs
    32.114 iters/sec. Estimated time to finish: 0:01:17.848522.
16          0.0076524   0.0845158             0.9977         0.9833                    299.077
     total [########################################..........] 80.00%
this epoch [..................................................]  0.00%
      9600 iter, 16 epoch / 20 epochs
    32.021 iters/sec. Estimated time to finish: 0:01:14.951347.
     total [########################################..........] 80.83%
this epoch [########..........................................] 16.67%
      9700 iter, 16 epoch / 20 epochs
    31.966 iters/sec. Estimated time to finish: 0:01:11.951340.
     total [########################################..........] 81.67%
this epoch [################..................................] 33.33%
      9800 iter, 16 epoch / 20 epochs
    31.917 iters/sec. Estimated time to finish: 0:01:08.928651.
     total [#########################################.........] 82.50%
this epoch [#########################.........................] 50.00%
      9900 iter, 16 epoch / 20 epochs
    31.865 iters/sec. Estimated time to finish: 0:01:05.903967.
     total [#########################################.........] 83.33%
this epoch [#################################.................] 66.67%
     10000 iter, 16 epoch / 20 epochs
    31.812 iters/sec. Estimated time to finish: 0:01:02.869297.
     total [##########################################........] 84.17%
this epoch [#########################################.........] 83.33%
     10100 iter, 16 epoch / 20 epochs
    31.743 iters/sec. Estimated time to finish: 0:00:59.854943.
17          0.0125142   0.0967522             0.996583       0.9808                    321.412
     total [##########################################........] 85.00%
this epoch [..................................................]  0.00%
     10200 iter, 17 epoch / 20 epochs
    31.571 iters/sec. Estimated time to finish: 0:00:57.014005.
     total [##########################################........] 85.83%
this epoch [########..........................................] 16.67%
     10300 iter, 17 epoch / 20 epochs
    31.412 iters/sec. Estimated time to finish: 0:00:54.119356.
     total [###########################################.......] 86.67%
this epoch [################..................................] 33.33%
     10400 iter, 17 epoch / 20 epochs
    31.253 iters/sec. Estimated time to finish: 0:00:51.194843.
     total [###########################################.......] 87.50%
this epoch [#########################.........................] 50.00%
     10500 iter, 17 epoch / 20 epochs
    31.052 iters/sec. Estimated time to finish: 0:00:48.305561.
     total [############################################......] 88.33%
this epoch [#################################.................] 66.67%
     10600 iter, 17 epoch / 20 epochs
    30.971 iters/sec. Estimated time to finish: 0:00:45.203923.
     total [############################################......] 89.17%
this epoch [#########################################.........] 83.33%
     10700 iter, 17 epoch / 20 epochs
    30.835 iters/sec. Estimated time to finish: 0:00:42.159730.
18          0.00738255  0.112494              0.997783       0.9795                    345.352
     total [#############################################.....] 90.00%
this epoch [..................................................]  0.00%
     10800 iter, 18 epoch / 20 epochs
    30.674 iters/sec. Estimated time to finish: 0:00:39.121586.
     total [#############################################.....] 90.83%
this epoch [########..........................................] 16.67%
     10900 iter, 18 epoch / 20 epochs
    30.563 iters/sec. Estimated time to finish: 0:00:35.991122.
     total [#############################################.....] 91.67%
this epoch [################..................................] 33.33%
     11000 iter, 18 epoch / 20 epochs
    30.458 iters/sec. Estimated time to finish: 0:00:32.831952.
     total [##############################################....] 92.50%
this epoch [#########################.........................] 50.00%
     11100 iter, 18 epoch / 20 epochs
    30.334 iters/sec. Estimated time to finish: 0:00:29.669973.
     total [##############################################....] 93.33%
this epoch [#################################.................] 66.67%
     11200 iter, 18 epoch / 20 epochs
    30.257 iters/sec. Estimated time to finish: 0:00:26.440229.
     total [###############################################...] 94.17%
this epoch [#########################################.........] 83.33%
     11300 iter, 18 epoch / 20 epochs
    30.178 iters/sec. Estimated time to finish: 0:00:23.195403.
19          0.0121511   0.0853964             0.9964         0.9833                    368.794
     total [###############################################...] 95.00%
this epoch [..................................................]  0.00%
     11400 iter, 19 epoch / 20 epochs
    30.066 iters/sec. Estimated time to finish: 0:00:19.956411.
     total [###############################################...] 95.83%
this epoch [########..........................................] 16.67%
     11500 iter, 19 epoch / 20 epochs
    29.966 iters/sec. Estimated time to finish: 0:00:16.685483.
     total [################################################..] 96.67%
this epoch [################..................................] 33.33%
     11600 iter, 19 epoch / 20 epochs
    29.849 iters/sec. Estimated time to finish: 0:00:13.400864.
     total [################################################..] 97.50%
this epoch [#########################.........................] 50.00%
     11700 iter, 19 epoch / 20 epochs
    29.753 iters/sec. Estimated time to finish: 0:00:10.082910.
     total [#################################################.] 98.33%
this epoch [#################################.................] 66.67%
     11800 iter, 19 epoch / 20 epochs
    29.675 iters/sec. Estimated time to finish: 0:00:06.739601.
     total [#################################################.] 99.17%
this epoch [#########################################.........] 83.33%
     11900 iter, 19 epoch / 20 epochs
    29.581 iters/sec. Estimated time to finish: 0:00:03.380585.
20          0.00638073  0.098195              0.997883       0.9814                    392.74
     total [##################################################] 100.00%
this epoch [..................................................]  0.00%
     12000 iter, 20 epoch / 20 epochs
    29.484 iters/sec. Estimated time to finish: 0:00:00.

</pre></div></div>
</div>
<p>Wrap model using s2i</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>s2i<span class="w"> </span>build<span class="w"> </span>.<span class="w"> </span>seldonio/seldon-core-s2i-python37-ubi8:1.7.0-dev<span class="w"> </span>chainer-mnist:0.1
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---&gt; Installing application source...
---&gt; Installing dependencies ...
Looking in links: /whl
Collecting chainer==6.2.0 (from -r requirements.txt (line 1))
  WARNING: Url '/whl' is ignored. It is either a non-existing path or lacks a specific scheme.
Downloading https://files.pythonhosted.org/packages/2c/5a/86c50a0119a560a39d782c4cdd9b72927c090cc2e3f70336e01b19a5f97a/chainer-6.2.0.tar.gz (873kB)
Requirement already satisfied: setuptools in /usr/local/lib/python3.6/site-packages (from chainer==6.2.0-&gt;-r requirements.txt (line 1)) (41.0.1)
Collecting typing&lt;=3.6.6 (from chainer==6.2.0-&gt;-r requirements.txt (line 1))
  WARNING: Url '/whl' is ignored. It is either a non-existing path or lacks a specific scheme.
Downloading https://files.pythonhosted.org/packages/4a/bd/eee1157fc2d8514970b345d69cb9975dcd1e42cd7e61146ed841f6e68309/typing-3.6.6-py3-none-any.whl
Collecting typing_extensions&lt;=3.6.6 (from chainer==6.2.0-&gt;-r requirements.txt (line 1))
  WARNING: Url '/whl' is ignored. It is either a non-existing path or lacks a specific scheme.
Downloading https://files.pythonhosted.org/packages/62/4f/392a1fa2873e646f5990eb6f956e662d8a235ab474450c72487745f67276/typing_extensions-3.6.6-py3-none-any.whl
Collecting filelock (from chainer==6.2.0-&gt;-r requirements.txt (line 1))
  WARNING: Url '/whl' is ignored. It is either a non-existing path or lacks a specific scheme.
Downloading https://files.pythonhosted.org/packages/93/83/71a2ee6158bb9f39a90c0dea1637f81d5eef866e188e1971a1b1ab01a35a/filelock-3.0.12-py3-none-any.whl
Requirement already satisfied: numpy&gt;=1.9.0 in /usr/local/lib/python3.6/site-packages (from chainer==6.2.0-&gt;-r requirements.txt (line 1)) (1.16.4)
Collecting protobuf&lt;3.8.0rc1,&gt;=3.0.0 (from chainer==6.2.0-&gt;-r requirements.txt (line 1))
  WARNING: Url '/whl' is ignored. It is either a non-existing path or lacks a specific scheme.
Downloading https://files.pythonhosted.org/packages/5a/aa/a858df367b464f5e9452e1c538aa47754d467023850c00b000287750fa77/protobuf-3.7.1-cp36-cp36m-manylinux1_x86_64.whl (1.2MB)
Requirement already satisfied: six&gt;=1.9.0 in /usr/local/lib/python3.6/site-packages (from chainer==6.2.0-&gt;-r requirements.txt (line 1)) (1.12.0)
Building wheels for collected packages: chainer
Building wheel for chainer (setup.py): started
Building wheel for chainer (setup.py): finished with status 'done'
Stored in directory: /root/.cache/pip/wheels/2e/be/c5/6ee506abcaa4a53106f7d7671bbee8b4e5243bc562a9d32ad1
Successfully built chainer
Installing collected packages: typing, typing-extensions, filelock, protobuf, chainer
Found existing installation: protobuf 3.8.0
Uninstalling protobuf-3.8.0:
Successfully uninstalled protobuf-3.8.0
Successfully installed chainer-6.2.0 filelock-3.0.12 protobuf-3.7.1 typing-3.6.6 typing-extensions-3.6.6
WARNING: Url '/whl' is ignored. It is either a non-existing path or lacks a specific scheme.
WARNING: You are using pip version 19.1, however version 19.2.2 is available.
You should consider upgrading via the 'pip install --upgrade pip' command.
Build completed successfully
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>docker<span class="w"> </span>run<span class="w"> </span>--name<span class="w"> </span><span class="s2">"mnist_predictor"</span><span class="w"> </span>-d<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:5000<span class="w"> </span>chainer-mnist:0.1
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
b03f58f82ca07e25261be34b75be4a0ffbbfa1ad736d3866790682bf0d8202a3
</pre></div></div>
</div>
<p>Send some random features that conform to the contract</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>seldon-core-tester<span class="w"> </span>contract.json<span class="w"> </span><span class="m">0</span>.0.0.0<span class="w"> </span><span class="m">5000</span><span class="w"> </span>-p
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
----------------------------------------
SENDING NEW REQUEST:

[[0.997 0.039 0.778 0.59  0.526 0.591 0.659 0.423 0.404 0.302 0.322 0.453
  0.54  0.852 0.268 0.564 0.163 0.032 0.934 0.317 0.395 0.122 0.056 0.729
  0.106 0.443 0.334 0.784 0.646 0.296 0.524 0.855 0.503 0.727 0.326 0.491
  0.385 0.042 0.82  0.715 0.972 0.699 0.431 0.618 0.096 0.849 0.224 0.187
  0.145 0.357 0.187 0.779 0.009 0.775 0.775 0.584 0.897 0.674 0.01  0.775
  0.095 0.081 0.089 0.351 0.985 0.878 0.906 0.396 0.499 0.646 0.127 0.966
  0.087 0.668 0.314 0.853 0.55  0.345 0.95  0.792 0.797 0.037 0.18  0.592
  0.941 0.662 0.101 0.388 0.902 0.868 0.505 0.824 0.8   0.855 0.568 0.368
  0.605 0.224 0.214 0.582 0.365 0.44  0.389 0.922 0.028 0.142 0.525 0.843
  0.706 0.61  0.215 0.962 0.334 0.273 0.365 0.075 0.929 0.693 0.382 0.76
  0.75  0.403 0.344 0.218 0.831 0.431 0.469 0.527 0.755 0.048 0.407 0.953
  0.468 0.186 0.589 0.839 0.513 0.307 0.251 0.738 0.173 0.185 0.499 0.797
  0.264 0.149 0.547 0.699 0.935 0.071 0.145 0.853 0.884 0.195 0.944 0.775
  0.523 0.627 0.729 0.826 0.894 0.117 0.935 0.363 0.03  0.16  0.435 0.579
  0.954 0.487 0.133 0.348 0.12  0.741 0.203 0.103 0.334 0.009 0.898 0.597
  0.375 0.241 0.27  0.094 0.819 0.737 0.147 0.715 0.138 0.801 0.427 0.602
  0.336 0.796 0.691 0.415 0.329 0.155 0.17  0.152 0.237 0.957 0.298 0.837
  0.982 0.805 0.972 0.125 0.916 0.101 0.054 0.347 0.566 0.232 0.885 0.864
  0.049 0.205 0.361 0.767 0.099 0.634 0.359 0.975 0.56  0.289 0.49  0.359
  0.901 0.39  0.197 0.985 0.141 0.232 0.336 0.932 0.923 0.032 0.126 0.51
  0.571 0.743 0.831 0.999 0.972 0.649 0.527 0.909 0.071 0.539 0.676 0.851
  0.104 0.103 0.392 0.641 0.838 0.333 0.453 0.573 0.199 0.924 0.588 0.955
  0.866 0.085 0.985 0.803 0.386 0.713 0.056 0.972 0.489 0.623 0.108 0.904
  0.746 0.986 0.824 0.996 0.161 0.738 0.24  0.153 0.935 0.782 0.393 0.098
  0.449 0.24  0.621 0.293 0.569 0.196 0.893 0.605 0.608 0.114 0.383 0.038
  0.573 0.373 0.474 0.006 0.292 0.738 0.943 0.65  0.553 0.684 0.3   0.587
  0.183 0.521 0.211 0.074 0.696 0.672 0.206 0.694 0.129 0.81  0.415 0.56
  0.994 0.686 0.807 0.514 0.215 0.096 0.295 0.233 0.625 0.663 0.794 0.16
  0.837 0.194 0.07  0.939 0.965 0.142 0.66  0.152 0.249 0.995 0.892 0.265
  0.865 0.742 0.19  0.03  0.42  0.807 0.15  0.163 0.529 0.23  0.59  0.676
  0.121 0.474 0.329 0.383 0.534 0.093 0.861 0.058 0.019 0.212 0.296 0.947
  0.879 0.445 0.357 0.021 0.551 0.362 0.653 0.258 0.146 0.453 0.373 0.448
  0.339 0.974 0.266 0.656 0.036 0.698 0.651 0.91  0.438 0.767 0.716 0.267
  0.871 0.781 0.13  0.912 0.13  0.332 0.647 0.31  0.171 0.323 0.703 0.197
  0.918 0.803 0.43  0.103 0.606 0.955 0.733 0.902 0.139 0.471 0.994 0.393
  0.95  0.485 0.782 0.213 0.994 0.206 0.938 0.019 0.429 0.135 0.811 0.209
  0.991 0.93  0.878 0.742 0.859 0.397 0.128 0.087 0.447 0.392 0.61  0.18
  0.087 0.641 0.31  0.033 0.211 0.431 0.051 0.639 0.461 0.466 0.171 0.736
  0.727 0.183 0.542 0.416 0.524 0.251 0.513 0.087 0.395 0.164 0.25  0.384
  0.705 0.683 0.827 0.188 0.163 0.325 0.256 0.904 0.161 0.334 0.639 0.728
  0.267 0.463 0.373 0.111 0.585 0.794 0.972 0.281 0.984 0.564 0.671 0.868
  0.741 0.638 0.702 0.778 0.667 0.372 0.818 0.49  0.102 0.403 0.187 0.283
  0.492 0.937 0.643 0.657 0.514 0.492 0.042 0.809 0.088 0.018 0.631 0.731
  0.516 0.625 0.597 0.629 0.798 0.907 0.861 0.439 0.777 0.014 0.771 0.152
  0.16  0.997 0.699 0.127 0.038 0.503 0.572 0.878 0.901 0.215 0.606 0.686
  0.847 0.007 0.976 0.895 0.357 0.374 0.989 0.544 0.317 0.043 0.718 0.788
  0.121 0.432 0.16  0.485 0.553 0.048 0.003 0.375 0.592 0.207 0.853 0.81
  0.043 0.554 0.084 0.584 0.73  0.766 0.738 0.038 0.56  0.475 0.763 0.002
  0.382 0.49  0.302 0.873 0.141 0.023 0.341 0.113 0.197 0.948 0.088 0.294
  0.778 0.807 0.935 0.712 0.466 0.885 0.815 0.843 0.745 0.217 0.664 0.142
  0.421 0.371 0.536 0.009 0.036 0.352 0.916 0.161 0.345 0.348 0.688 0.806
  0.434 0.413 0.567 0.043 0.934 0.072 0.54  0.347 0.817 0.321 0.85  0.478
  0.832 0.899 0.283 0.34  0.304 0.955 0.915 0.934 0.452 0.423 0.75  0.013
  0.5   0.691 0.854 0.453 0.959 0.843 0.698 0.756 0.918 0.992 0.663 0.608
  0.756 0.7   0.347 0.427 0.198 0.37  0.837 0.362 0.291 0.126 0.695 0.777
  0.318 0.88  0.859 0.958 0.075 0.332 0.321 0.179 0.834 0.027 0.332 0.799
  0.504 0.274 0.819 0.081 0.337 0.02  0.598 0.727 0.159 0.937 0.199 0.639
  0.063 0.75  0.637 0.686 0.677 0.102 0.135 0.264 0.091 0.837 0.562 0.453
  0.503 0.884 0.147 0.966 0.118 0.293 0.327 0.859 0.958 0.498 0.369 0.123
  0.354 0.812 0.163 0.96  0.64  0.596 0.029 0.84  0.159 0.717 0.025 0.394
  0.185 0.29  0.554 0.646 0.432 0.197 0.668 0.531 0.206 0.599 0.842 0.579
  0.836 0.889 0.797 0.891 0.1   0.087 0.825 0.952 0.781 0.295 0.819 0.038
  0.34  0.476 0.08  0.784 0.556 0.282 0.699 0.954 0.5   0.332 0.213 0.618
  0.92  0.776 0.147 0.749 0.597 0.191 0.957 0.47  0.324 0.352 0.837 0.263
  0.536 0.48  0.997 0.417 0.08  0.464 0.886 0.019 0.307 0.164 0.36  0.638
  0.46  0.803 0.139 0.575]]
Traceback (most recent call last):
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/urllib3/connection.py", line 160, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/urllib3/util/connection.py", line 80, in create_connection
    raise err
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/urllib3/util/connection.py", line 70, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/urllib3/connectionpool.py", line 603, in urlopen
    chunked=chunked)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/urllib3/connectionpool.py", line 355, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/http/client.py", line 1244, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/http/client.py", line 1290, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/http/client.py", line 1239, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/http/client.py", line 1026, in _send_output
    self.send(msg)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/http/client.py", line 966, in send
    self.connect()
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/urllib3/connection.py", line 183, in connect
    conn = self._new_conn()
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/urllib3/connection.py", line 169, in _new_conn
    self, "Failed to establish a new connection: %s" % e)
urllib3.exceptions.NewConnectionError: &lt;urllib3.connection.HTTPConnection object at 0x1232a2050&gt;: Failed to establish a new connection: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/urllib3/connectionpool.py", line 641, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/urllib3/util/retry.py", line 399, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='0.0.0.0', port=5000): Max retries exceeded with url: /predict (Caused by NewConnectionError('&lt;urllib3.connection.HTTPConnection object at 0x1232a2050&gt;: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/bin/seldon-core-tester", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/seldon_core/microservice_tester.py", line 258, in main
    run_predict(args)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/seldon_core/microservice_tester.py", line 225, in run_predict
    response = sc.microservice(data=batch, transport=transport, method="predict", payload_type=payload_type, names=feature_names)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/seldon_core/seldon_client.py", line 395, in microservice
    return microservice_api_rest_seldon_message(**k)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/seldon_core/seldon_client.py", line 534, in microservice_api_rest_seldon_message
    data={"json": json.dumps(payload)})
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/requests/api.py", line 116, in post
    return request('post', url, data=data, json=json, **kwargs)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/requests/api.py", line 60, in request
    return session.request(method=method, url=url, **kwargs)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/requests/sessions.py", line 533, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/requests/sessions.py", line 646, in send
    r = adapter.send(request, **kwargs)
  File "/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/requests/adapters.py", line 516, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='0.0.0.0', port=5000): Max retries exceeded with url: /predict (Caused by NewConnectionError('&lt;urllib3.connection.HTTPConnection object at 0x1232a2050&gt;: Failed to establish a new connection: [Errno 61] Connection refused'))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>docker<span class="w"> </span>rm<span class="w"> </span>mnist_predictor<span class="w"> </span>--force
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error: No such container: mnist_predictor
</pre></div></div>
</div>
</section>
</section>
<section id="Test-using-Minikube">
<h1 id="Test-using-Minikube">Test using Minikube<a class="headerlink" href="#Test-using-Minikube" title="Permalink to this heading">¶</a></h1>
<p><strong>Due to a</strong><a class="reference external" href="https://github.com/SeldonIO/seldon-core/issues/253">minikube/s2i issue</a><strong>you will need</strong><a class="reference external" href="https://github.com/openshift/source-to-image/releases/tag/v1.1.13">s2i &gt;= 1.1.13</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>minikube<span class="w"> </span>start<span class="w"> </span>--memory<span class="w"> </span><span class="m">4096</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
😄  minikube v1.2.0 on darwin (amd64)
🔥  Creating virtualbox VM (CPUs=2, Memory=4096MB, Disk=20000MB) ...
🐳  Configuring environment for Kubernetes v1.15.0 on Docker 18.09.6
🚜  Pulling images ...
🚀  Launching Kubernetes ...
⌛  Verifying: apiserver proxy etcd scheduler controller dns
🏄  Done! kubectl is now configured to use "minikube"
</pre></div></div>
</div>
<section id="Setup-Seldon-Core">
<h2 id="Setup-Seldon-Core">Setup Seldon Core<a class="headerlink" href="#Setup-Seldon-Core" title="Permalink to this heading">¶</a></h2>
<p>Use the setup notebook to <a class="reference external" href="https://docs.seldon.io/projects/seldon-core/en/latest/examples/seldon_core_setup.html#Setup-Cluster">Setup Cluster</a> with <a class="reference external" href="https://docs.seldon.io/projects/seldon-core/en/latest/examples/seldon_core_setup.html#Ambassador">Ambassador Ingress</a> and <a class="reference external" href="https://docs.seldon.io/projects/seldon-core/en/latest/examples/seldon_core_setup.html#Install-Seldon-Core">Install Seldon Core</a>. Instructions <a class="reference external" href="https://docs.seldon.io/projects/seldon-core/en/latest/examples/seldon_core_setup.html">also
online</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="nb">eval</span><span class="w"> </span><span class="k">$(</span>minikube<span class="w"> </span>docker-env<span class="k">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>s2i<span class="w"> </span>build<span class="w"> </span>.<span class="w"> </span>seldonio/seldon-core-s2i-python37-ubi8:1.7.0-dev<span class="w"> </span>chainer-mnist:0.1
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---&gt; Installing application source...
---&gt; Installing dependencies ...
Looking in links: /whl
Collecting chainer==6.2.0 (from -r requirements.txt (line 1))
  WARNING: Url '/whl' is ignored. It is either a non-existing path or lacks a specific scheme.
Downloading https://files.pythonhosted.org/packages/2c/5a/86c50a0119a560a39d782c4cdd9b72927c090cc2e3f70336e01b19a5f97a/chainer-6.2.0.tar.gz (873kB)
Requirement already satisfied: setuptools in /usr/local/lib/python3.6/site-packages (from chainer==6.2.0-&gt;-r requirements.txt (line 1)) (41.0.1)
Collecting typing&lt;=3.6.6 (from chainer==6.2.0-&gt;-r requirements.txt (line 1))
  WARNING: Url '/whl' is ignored. It is either a non-existing path or lacks a specific scheme.
Downloading https://files.pythonhosted.org/packages/4a/bd/eee1157fc2d8514970b345d69cb9975dcd1e42cd7e61146ed841f6e68309/typing-3.6.6-py3-none-any.whl
Collecting typing_extensions&lt;=3.6.6 (from chainer==6.2.0-&gt;-r requirements.txt (line 1))
  WARNING: Url '/whl' is ignored. It is either a non-existing path or lacks a specific scheme.
Downloading https://files.pythonhosted.org/packages/62/4f/392a1fa2873e646f5990eb6f956e662d8a235ab474450c72487745f67276/typing_extensions-3.6.6-py3-none-any.whl
Collecting filelock (from chainer==6.2.0-&gt;-r requirements.txt (line 1))
  WARNING: Url '/whl' is ignored. It is either a non-existing path or lacks a specific scheme.
Downloading https://files.pythonhosted.org/packages/93/83/71a2ee6158bb9f39a90c0dea1637f81d5eef866e188e1971a1b1ab01a35a/filelock-3.0.12-py3-none-any.whl
Requirement already satisfied: numpy&gt;=1.9.0 in /usr/local/lib/python3.6/site-packages (from chainer==6.2.0-&gt;-r requirements.txt (line 1)) (1.16.4)
Collecting protobuf&lt;3.8.0rc1,&gt;=3.0.0 (from chainer==6.2.0-&gt;-r requirements.txt (line 1))
  WARNING: Url '/whl' is ignored. It is either a non-existing path or lacks a specific scheme.
Downloading https://files.pythonhosted.org/packages/5a/aa/a858df367b464f5e9452e1c538aa47754d467023850c00b000287750fa77/protobuf-3.7.1-cp36-cp36m-manylinux1_x86_64.whl (1.2MB)
Requirement already satisfied: six&gt;=1.9.0 in /usr/local/lib/python3.6/site-packages (from chainer==6.2.0-&gt;-r requirements.txt (line 1)) (1.12.0)
Building wheels for collected packages: chainer
Building wheel for chainer (setup.py): started
Building wheel for chainer (setup.py): finished with status 'done'
Stored in directory: /root/.cache/pip/wheels/2e/be/c5/6ee506abcaa4a53106f7d7671bbee8b4e5243bc562a9d32ad1
Successfully built chainer
Installing collected packages: typing, typing-extensions, filelock, protobuf, chainer
Found existing installation: protobuf 3.8.0
Uninstalling protobuf-3.8.0:
Successfully uninstalled protobuf-3.8.0
Successfully installed chainer-6.2.0 filelock-3.0.12 protobuf-3.7.1 typing-3.6.6 typing-extensions-3.6.6
WARNING: Url '/whl' is ignored. It is either a non-existing path or lacks a specific scheme.
WARNING: You are using pip version 19.1, however version 19.2.2 is available.
You should consider upgrading via the 'pip install --upgrade pip' command.
Build completed successfully
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>chainer_mnist_deployment.json
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
seldondeployment.machinelearning.seldon.io/seldon-deployment-example created
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>kubectl<span class="w"> </span>rollout<span class="w"> </span>status<span class="w"> </span>deploy/chainer-mnist-deployment-chainer-mnist-predictor-76478b2
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Waiting for deployment "chainer-mnist-deployment-chainer-mnist-predictor-76478b2" rollout to finish: 0 of 1 updated replicas are available...
deployment "chainer-mnist-deployment-chainer-mnist-predictor-76478b2" successfully rolled out
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>seldon-core-api-tester<span class="w"> </span>contract.json<span class="w"> </span><span class="sb">`</span>minikube<span class="w"> </span>ip<span class="sb">`</span><span class="w"> </span><span class="sb">`</span>kubectl<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>ambassador<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.spec.ports[0].nodePort}'</span><span class="sb">`</span><span class="w"> </span><span class="err">\</span>
    <span class="n">seldon</span><span class="o">-</span><span class="n">deployment</span><span class="o">-</span><span class="n">example</span> <span class="o">--</span><span class="n">namespace</span> <span class="n">default</span> <span class="o">-</span><span class="n">p</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/Users/dtaniwaki/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
----------------------------------------
SENDING NEW REQUEST:

[[0.64  0.213 0.028 0.604 0.586 0.076 0.629 0.568 0.806 0.931 0.266 0.098
  0.526 0.336 0.569 0.965 0.157 0.401 0.15  0.405 0.594 0.21  0.699 0.085
  0.314 0.467 0.303 0.384 0.788 0.135 0.349 0.467 0.025 0.525 0.767 0.819
  0.275 0.212 0.784 0.448 0.808 0.582 0.939 0.165 0.761 0.272 0.332 0.321
  0.005 0.921 0.285 0.181 0.161 0.948 0.148 0.788 0.664 0.65  0.795 0.548
  0.754 0.407 0.057 0.429 0.569 0.538 0.295 0.4   0.581 0.569 0.299 0.066
  0.456 0.118 0.983 0.93  0.316 0.865 0.492 0.048 0.505 0.573 0.595 0.13
  0.595 0.595 0.474 0.334 0.708 0.25  0.183 0.391 0.268 0.252 0.366 0.029
  0.676 0.869 0.12  0.737 0.502 0.868 0.846 0.891 0.578 0.598 0.984 0.543
  0.515 0.081 0.998 0.976 0.611 0.492 0.494 0.985 0.443 0.246 0.252 0.871
  0.615 0.885 0.903 0.254 0.651 0.412 0.645 0.608 0.921 0.5   0.18  0.845
  0.91  0.601 0.782 0.27  0.643 0.671 0.273 0.37  0.454 0.08  0.854 0.439
  0.912 0.709 0.703 0.817 0.381 0.963 0.057 0.015 0.126 0.686 0.284 0.463
  0.231 0.332 0.932 0.804 0.538 0.039 0.12  0.992 0.436 0.791 0.261 0.842
  0.901 0.208 0.578 0.423 0.657 0.293 0.633 0.45  0.609 0.715 0.149 0.244
  0.026 0.332 0.525 0.157 0.749 0.88  0.713 0.405 0.473 0.01  0.038 0.807
  0.934 0.157 0.141 0.155 0.124 0.781 0.738 0.018 0.42  0.635 0.867 0.925
  0.398 0.505 0.695 0.429 0.174 0.327 0.123 0.967 0.378 0.224 0.393 0.053
  0.344 0.731 0.02  0.848 0.079 0.814 0.023 0.087 0.578 0.642 0.18  0.563
  0.276 0.491 0.021 0.719 0.85  0.156 0.031 0.506 0.271 0.095 0.186 0.002
  0.799 0.138 0.734 0.925 0.881 0.187 0.559 0.946 0.826 0.488 0.744 0.322
  0.333 0.322 0.665 0.032 0.663 0.754 0.495 0.569 0.917 0.167 0.168 0.409
  0.369 0.363 0.23  0.961 0.201 0.463 0.565 0.834 0.431 0.848 0.742 0.436
  0.061 0.656 0.3   0.128 0.485 0.78  0.617 0.082 0.396 0.416 0.673 0.961
  0.727 0.986 0.222 0.909 0.898 0.144 0.639 0.046 0.101 0.546 0.782 0.069
  0.672 0.824 0.861 0.981 0.003 0.591 0.303 0.384 0.67  0.7   0.834 0.475
  0.932 0.949 0.938 0.945 0.368 0.522 0.833 0.045 0.452 0.068 0.165 0.569
  0.44  0.702 0.727 0.069 0.686 0.262 0.891 0.547 0.994 0.454 0.947 0.364
  0.154 0.322 0.571 0.19  0.476 0.925 0.871 0.605 0.442 0.585 0.544 0.316
  0.915 0.253 0.973 0.501 0.402 0.96  0.206 0.501 0.37  0.463 0.904 0.981
  0.969 0.877 0.724 0.5   0.447 0.499 0.443 0.349 0.79  0.051 0.384 0.27
  0.094 0.774 0.742 0.16  0.517 0.266 0.908 0.796 0.862 0.987 0.939 0.909
  0.962 0.587 0.964 0.159 0.029 0.952 0.416 0.72  0.346 0.257 0.152 0.233
  0.862 0.457 0.153 0.076 0.105 0.634 0.652 0.435 0.757 0.985 0.487 0.114
  0.95  0.217 0.877 0.483 0.302 0.929 0.856 0.768 0.223 0.006 0.841 0.565
  0.611 0.407 0.71  0.588 0.654 0.197 0.506 0.938 0.779 0.387 0.007 0.482
  0.523 0.993 0.671 0.044 0.497 0.71  0.418 0.06  0.114 0.082 0.811 0.083
  0.773 0.134 0.87  0.414 0.787 0.972 0.132 0.047 0.593 0.502 0.15  0.042
  0.363 0.311 0.17  0.895 0.569 0.774 0.006 0.408 0.92  0.753 0.543 0.279
  0.911 0.314 0.195 0.538 0.977 0.606 0.954 0.378 0.397 0.261 0.085 0.656
  0.978 0.598 0.216 0.832 0.105 0.958 0.185 0.81  0.444 0.308 0.013 0.176
  0.603 0.383 0.671 0.436 0.981 0.072 0.713 0.349 0.962 0.055 0.315 0.417
  0.052 0.076 0.198 0.786 0.397 0.757 0.145 0.539 0.671 0.583 0.42  0.575
  0.563 0.286 0.788 0.481 0.403 0.85  0.864 0.945 0.427 0.511 0.268 0.091
  0.049 0.611 0.137 0.58  0.281 0.057 0.453 0.461 0.895 0.701 0.662 0.599
  0.967 0.562 0.295 0.6   0.742 0.909 0.69  0.383 0.553 0.078 0.949 0.109
  0.771 0.083 0.712 0.514 0.549 0.403 0.575 0.494 0.31  0.307 0.091 0.874
  0.591 0.315 0.199 0.372 0.131 0.905 0.32  0.284 0.516 0.055 0.832 0.042
  0.927 0.667 0.273 0.426 0.054 0.799 0.356 0.564 0.223 0.772 0.79  0.628
  0.893 0.512 0.523 0.518 0.48  0.869 0.49  0.416 0.775 0.864 0.921 0.968
  0.109 0.812 0.943 0.042 0.179 0.943 0.324 0.079 0.017 0.226 0.848 0.803
  0.873 0.834 0.696 0.582 0.125 0.042 0.917 0.909 0.491 0.5   0.101 0.779
  0.65  0.424 0.94  0.582 0.706 0.935 0.286 0.057 0.544 0.198 0.893 0.537
  0.405 0.91  0.908 0.297 0.288 0.368 0.654 0.347 0.002 0.677 0.32  0.691
  0.17  0.133 0.586 0.857 0.001 0.639 0.223 0.164 0.689 0.97  0.913 0.947
  0.962 0.44  0.201 0.343 0.493 0.662 0.728 0.295 0.445 0.739 0.764 0.955
  0.206 0.298 0.996 0.835 0.983 0.033 0.801 0.284 0.621 0.941 0.293 0.865
  0.158 0.788 0.681 0.613 0.705 0.753 0.006 0.175 0.414 0.299 0.116 0.67
  0.66  0.845 0.905 0.369 0.11  0.841 0.717 0.348 0.537 0.116 0.024 0.575
  0.211 0.427 0.84  0.447 0.056 0.427 0.39  0.424 0.48  0.738 0.698 0.377
  0.143 0.242 0.877 0.238 0.188 0.786 0.965 0.112 0.952 0.679 0.916 0.13
  0.882 0.353 0.433 0.608 0.297 0.558 0.663 0.646 0.185 0.91  0.131 0.217
  0.549 0.759 0.087 0.96  0.11  0.613 0.643 0.218 0.126 0.535 0.751 0.097
  0.681 0.782 0.367 0.197 0.05  0.742 0.623 0.763 0.625 0.317 0.364 0.879
  0.445 0.751 0.87  0.727 0.879 0.035 0.412 0.907 0.895 0.923 0.373 0.22
  0.21  0.176 0.182 0.821]]
RECEIVED RESPONSE:
meta {
  puid: "c88qkq0g5nsdtkero34a1i56dv"
  requestPath {
    key: "chainer-mnist-classifier"
    value: "chainer-mnist:0.1"
  }
}
data {
  names: "t:0"
  names: "t:1"
  names: "t:2"
  names: "t:3"
  names: "t:4"
  names: "t:5"
  names: "t:6"
  names: "t:7"
  names: "t:8"
  names: "t:9"
  ndarray {
    values {
      list_value {
        values {
          number_value: 2.4670965671539307
        }
        values {
          number_value: -4.471328258514404
        }
        values {
          number_value: -12.0973482131958
        }
        values {
          number_value: -8.344386100769043
        }
        values {
          number_value: -1.4862585067749023
        }
        values {
          number_value: -2.065153121948242
        }
        values {
          number_value: 1.480709195137024
        }
        values {
          number_value: -6.679415702819824
        }
        values {
          number_value: -7.224794864654541
        }
        values {
          number_value: -7.008320331573486
        }
      }
    }
  }
}


</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>minikube<span class="w"> </span>delete
</pre></div>
</div>
</div>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="iter8-separate.html" title="Progressive Rollouts using Two Seldon Deployments"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Progressive Rollouts using Two Seldon Deployments </span>
              </div>
            </a>
          
          
            <a href="transformers-v2-protocol.html" title="Custom pre-processors with the V2 protocol"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> Custom pre-processors with the V2 protocol </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2024, Seldon Technologies Ltd.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>