
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Analyzing Tune Experiment Results &#8212; Ray 2.7.2</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/termynal.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/versionwarning.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script defer="defer" src="../../_static/js/docsearch.js"></script>
    <script defer="defer" src="../../_static/js/csat.js"></script>
    <script defer="defer" src="../../_static/js/termynal.js"></script>
    <script defer="defer" src="../../_static/js/custom.js"></script>
    <script defer="defer" src="../../_static/js/top-navigation.js"></script>
    <script src="../../_static/js/tags.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <link rel="canonical" href="https://docs.ray.io/en/latest/tune/examples/tune_analyze_results.html" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="A Guide to Population Based Training with Tune" href="pbt_guide.html" />
    <link rel="prev" title="Getting Data in and out of Tune" href="../tutorials/tune_get_data_in_and_out.html" />

<!-- Fathom - beautiful, simple website analytics -->
<script src="https://deer.ray.io/script.js" data-site="WYYANYOS" defer></script>
<!-- / Fathom -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110413294-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110413294-1');
</script>

<script
  src="https://widget.kapa.ai/kapa-widget.bundle.js"
  data-website-id="18a8c339-4ec5-43c8-8182-db3f2bc8c6b6"
  data-project-name="Ray"
  data-project-color="#2C2C2C"
  data-project-logo="https://global.discourse-cdn.com/business7/uploads/ray/original/1X/8f4dcb72f7cd34e2a332d548bd65860994bc8ff1.png"
  data-modal-disclaimer = "Results are automated and may be incorrect or contain inappropriate information. Do not include any personal data or confidential information."
  data-modal-title = "Ray Docs AI - Ask a Question"
  data-button-position-bottom = "60px"
></script>

<script>
(function(apiKey){
    (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
    v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
        o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
        y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
        z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id: 'VISITOR-UNIQUE-ID'
            },
            account: {
                id: 'ACCOUNT-UNIQUE-ID'
            }
        });
})('f89fa48a-6dd7-4d7c-67cf-a8051ed891f2');
</script>



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"><div class='topnav'></div></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Ray 2.7.2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main Navigation">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    欢迎来到 Ray ！
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Ray
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/index.html">
   概述「100%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/getting-started.html">
   入门「100%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/installation.html">
   安装「100%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/use-cases.html">
   用例「100%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/examples.html">
   示例库「1%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-overview/ray-libraries.html">
   生态「3%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-core/walkthrough.html">
   Ray 核心「100%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../data/data.html">
   Ray 数据「85%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../train/train.html">
   Ray 训练「95%」
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../index.html">
   Ray 调参「0%」
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../getting-started.html">
     入门
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../key-concepts.html">
     关键概念
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../tutorials/overview.html">
     用户指南
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune-run.html">
       运行基础实验
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune-output.html">
       Logging and Outputs in Tune
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune-resources.html">
       设置实验资源
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune-search-spaces.html">
       使用搜索空间
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune-stopping.html">
       How to Define Stopping Criteria for a Ray Tune Experiment
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune-trial-checkpoints.html">
       How to Save and Load Trial Checkpoints
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune-storage.html">
       How to Configure Persistent Storage in Ray Tune
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune-fault-tolerance.html">
       How to Enable Fault Tolerance in Ray Tune
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune-metrics.html">
       使用回调和指标
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune_get_data_in_and_out.html">
       Getting Data in and out of Tune
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Analyzing Tune Experiment Results
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="pbt_guide.html">
       A Guide to Population Based Training with Tune
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune-distributed.html">
       云上部署 Tune
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune-lifecycle.html">
       Tune 架构
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tutorials/tune-scalability.html">
       可扩展性基准
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="index.html">
     Ray Tune 示例
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../faq.html">
     Ray Tune 问答
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/api.html">
     Ray Tune API
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../serve/index.html">
   Ray Serve「1%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rllib/index.html">
   Ray RLlib「0%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-more-libs/index.html">
   更多类库「40%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cluster/getting-started.html">
   Ray 集群「100%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-observability/index.html">
   监控调试「100%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-references/api.html">
   参考「20%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-contribute/index.html">
   开发者指引「30%」
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ray-security/index.html">
   安全「100%」
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ray-project/ray"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ray-project/ray/issues/new?title=Issue%20on%20page%20%2Ftune/examples/tune_analyze_results.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ray-project/ray/edit/master/doc/source/tune/examples/tune_analyze_results.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/tune/examples/tune_analyze_results.ipynb.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-experiment-results-from-an-directory">
   Loading experiment results from an directory
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#experiment-level-analysis-working-with-resultgrid">
   Experiment-level Analysis: Working with
   <code class="docutils literal notranslate">
    <span class="pre">
     ResultGrid
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trial-level-analysis-working-with-an-individual-result">
   Trial-level Analysis: Working with an individual
   <code class="docutils literal notranslate">
    <span class="pre">
     Result
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-metrics">
   Plotting metrics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accessing-checkpoints-and-loading-for-test-inference">
   Accessing checkpoints and loading for test inference
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Analyzing Tune Experiment Results</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-experiment-results-from-an-directory">
   Loading experiment results from an directory
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#experiment-level-analysis-working-with-resultgrid">
   Experiment-level Analysis: Working with
   <code class="docutils literal notranslate">
    <span class="pre">
     ResultGrid
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trial-level-analysis-working-with-an-individual-result">
   Trial-level Analysis: Working with an individual
   <code class="docutils literal notranslate">
    <span class="pre">
     Result
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-metrics">
   Plotting metrics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accessing-checkpoints-and-loading-for-test-inference">
   Accessing checkpoints and loading for test inference
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="analyzing-tune-experiment-results">
<span id="tune-analysis-guide"></span><h1>Analyzing Tune Experiment Results<a class="headerlink" href="#analyzing-tune-experiment-results" title="Permalink to this headline">#</a></h1>
<p>In this guide, we’ll walk through some common workflows of what analysis you might want to perform after running your Tune experiment with <code class="docutils literal notranslate"><span class="pre">tuner.fit()</span></code>.</p>
<ol class="simple">
<li><p>Loading Tune experiment results from a directory</p></li>
<li><p>Basic <em>experiment-level</em> analysis: get a quick overview of how trials performed</p></li>
<li><p>Basic <em>trial-level</em> analysis: access individual trial hyperparameter configs and last reported metrics</p></li>
<li><p>Plotting the entire history of reported metrics for a trial</p></li>
<li><p>Accessing saved checkpoints (assuming that you have enabled checkpointing) and loading into a model for test inference</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result_grid</span><span class="p">:</span> <span class="n">ResultGrid</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">best_result</span><span class="p">:</span> <span class="n">Result</span> <span class="o">=</span> <span class="n">result_grid</span><span class="o">.</span><span class="n">get_best_result</span><span class="p">()</span>
</pre></div>
</div>
<p>The output of <code class="docutils literal notranslate"><span class="pre">tuner.fit()</span></code> is a <a class="reference internal" href="../api/result_grid.html#result-grid-docstring"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">ResultGrid</span></code></span></a>, which is a collection of <a class="reference internal" href="../api/result_grid.html#result-docstring"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">Result</span></code></span></a> objects. See the linked documentation references for <a class="reference internal" href="../api/result_grid.html#result-grid-docstring"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">ResultGrid</span></code></span></a> and <a class="reference internal" href="../api/result_grid.html#result-docstring"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">Result</span></code></span></a> for more details on what attributes are available.</p>
<p>Let’s start by performing a hyperparameter search with the MNIST PyTorch example. The training function is defined <a class="reference internal" href="includes/mnist_pytorch.html"><span class="doc">here</span></a>, and we pass it into a <code class="docutils literal notranslate"><span class="pre">Tuner</span></code> to start running the trials in parallel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">ray</span> <span class="kn">import</span> <span class="n">train</span><span class="p">,</span> <span class="n">tune</span>
<span class="kn">from</span> <span class="nn">ray.tune.examples.mnist_pytorch</span> <span class="kn">import</span> <span class="n">train_mnist</span>
<span class="kn">from</span> <span class="nn">ray.tune</span> <span class="kn">import</span> <span class="n">ResultGrid</span>

<span class="n">storage_path</span> <span class="o">=</span> <span class="s2">&quot;/tmp/ray_results&quot;</span>
<span class="n">exp_name</span> <span class="o">=</span> <span class="s2">&quot;tune_analyzing_results&quot;</span>
<span class="n">tuner</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">Tuner</span><span class="p">(</span>
    <span class="n">train_mnist</span><span class="p">,</span>
    <span class="n">param_space</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
        <span class="s2">&quot;momentum&quot;</span><span class="p">:</span> <span class="n">tune</span><span class="o">.</span><span class="n">grid_search</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">]),</span>
        <span class="s2">&quot;should_checkpoint&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">run_config</span><span class="o">=</span><span class="n">train</span><span class="o">.</span><span class="n">RunConfig</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">exp_name</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;training_iteration&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
        <span class="n">checkpoint_config</span><span class="o">=</span><span class="n">train</span><span class="o">.</span><span class="n">CheckpointConfig</span><span class="p">(</span>
            <span class="n">checkpoint_score_attribute</span><span class="o">=</span><span class="s2">&quot;mean_accuracy&quot;</span><span class="p">,</span>
            <span class="n">num_to_keep</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">storage_path</span><span class="o">=</span><span class="n">storage_path</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">tune_config</span><span class="o">=</span><span class="n">tune</span><span class="o">.</span><span class="n">TuneConfig</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;mean_accuracy&quot;</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">result_grid</span><span class="p">:</span> <span class="n">ResultGrid</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class="tuneStatus">
  <div style="display: flex;flex-direction: row">
    <div style="display: flex;flex-direction: column;">
      <h3>Tune Status</h3>
      <table>
<tbody>
<tr><td>Current time:</td><td>2023-08-25 17:42:39</td></tr>
<tr><td>Running for: </td><td>00:00:12.43        </td></tr>
<tr><td>Memory:      </td><td>27.0/64.0 GiB      </td></tr>
</tbody>
</table>
    </div>
    <div class="vDivider"></div>
    <div class="systemInfo">
      <h3>System Info</h3>
      Using FIFO scheduling algorithm.<br>Logical resource usage: 1.0/10 CPUs, 0/0 GPUs
    </div>

  </div>
  <div class="hDivider"></div>
  <div class="trialStatus">
    <h3>Trial Status</h3>
    <table>
<thead>
<tr><th>Trial name             </th><th>status    </th><th>loc            </th><th style="text-align: right;">        lr</th><th style="text-align: right;">  momentum</th><th style="text-align: right;">     acc</th><th style="text-align: right;">  iter</th><th style="text-align: right;">  total time (s)</th></tr>
</thead>
<tbody>
<tr><td>train_mnist_6e465_00000</td><td>TERMINATED</td><td>127.0.0.1:94903</td><td style="text-align: right;">0.0188636 </td><td style="text-align: right;">      0.8 </td><td style="text-align: right;">0.925   </td><td style="text-align: right;">   100</td><td style="text-align: right;">         8.81282</td></tr>
<tr><td>train_mnist_6e465_00001</td><td>TERMINATED</td><td>127.0.0.1:94904</td><td style="text-align: right;">0.0104137 </td><td style="text-align: right;">      0.9 </td><td style="text-align: right;">0.9625  </td><td style="text-align: right;">   100</td><td style="text-align: right;">         8.6819 </td></tr>
<tr><td>train_mnist_6e465_00002</td><td>TERMINATED</td><td>127.0.0.1:94905</td><td style="text-align: right;">0.00102317</td><td style="text-align: right;">      0.99</td><td style="text-align: right;">0.953125</td><td style="text-align: right;">   100</td><td style="text-align: right;">         8.67491</td></tr>
<tr><td>train_mnist_6e465_00003</td><td>TERMINATED</td><td>127.0.0.1:94906</td><td style="text-align: right;">0.0103929 </td><td style="text-align: right;">      0.8 </td><td style="text-align: right;">0.94375 </td><td style="text-align: right;">   100</td><td style="text-align: right;">         8.92996</td></tr>
<tr><td>train_mnist_6e465_00004</td><td>TERMINATED</td><td>127.0.0.1:94907</td><td style="text-align: right;">0.00808686</td><td style="text-align: right;">      0.9 </td><td style="text-align: right;">0.95625 </td><td style="text-align: right;">   100</td><td style="text-align: right;">         8.75311</td></tr>
<tr><td>train_mnist_6e465_00005</td><td>TERMINATED</td><td>127.0.0.1:94908</td><td style="text-align: right;">0.00172525</td><td style="text-align: right;">      0.99</td><td style="text-align: right;">0.95625 </td><td style="text-align: right;">   100</td><td style="text-align: right;">         8.76523</td></tr>
<tr><td>train_mnist_6e465_00006</td><td>TERMINATED</td><td>127.0.0.1:94909</td><td style="text-align: right;">0.0507692 </td><td style="text-align: right;">      0.8 </td><td style="text-align: right;">0.946875</td><td style="text-align: right;">   100</td><td style="text-align: right;">         8.94565</td></tr>
<tr><td>train_mnist_6e465_00007</td><td>TERMINATED</td><td>127.0.0.1:94910</td><td style="text-align: right;">0.00978134</td><td style="text-align: right;">      0.9 </td><td style="text-align: right;">0.965625</td><td style="text-align: right;">   100</td><td style="text-align: right;">         8.77776</td></tr>
<tr><td>train_mnist_6e465_00008</td><td>TERMINATED</td><td>127.0.0.1:94911</td><td style="text-align: right;">0.00368709</td><td style="text-align: right;">      0.99</td><td style="text-align: right;">0.934375</td><td style="text-align: right;">   100</td><td style="text-align: right;">         8.8495 </td></tr>
</tbody>
</table>
  </div>
</div>
<style>
.tuneStatus {
  color: var(--jp-ui-font-color1);
}
.tuneStatus .systemInfo {
  display: flex;
  flex-direction: column;
}
.tuneStatus td {
  white-space: nowrap;
}
.tuneStatus .trialStatus {
  display: flex;
  flex-direction: column;
}
.tuneStatus h3 {
  font-weight: bold;
}
.tuneStatus .hDivider {
  border-bottom-width: var(--jp-border-width);
  border-bottom-color: var(--jp-border-color0);
  border-bottom-style: solid;
}
.tuneStatus .vDivider {
  border-left-width: var(--jp-border-width);
  border-left-color: var(--jp-border-color0);
  border-left-style: solid;
  margin: 0.5em 1em 0.5em 1em;
}
</style>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-08-25 17:42:27,603	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94906)</span> StorageContext on SESSION (rank=None):
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94906)</span> StorageContext&lt;
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94906)</span>   storage_path=/tmp/ray_results
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94906)</span>   storage_local_path=/Users/justin/ray_results
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94906)</span>   storage_filesystem=&lt;pyarrow._fs.LocalFileSystem object at 0x149b763b0&gt;
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94906)</span>   storage_fs_path=/tmp/ray_results
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94906)</span>   experiment_dir_name=tune_analyzing_results
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94906)</span>   trial_dir_name=train_mnist_6e465_00003_3_lr=0.0104,momentum=0.8000_2023-08-25_17-42-27
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94906)</span>   current_checkpoint_index=0
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94906)</span> &gt;
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(train_mnist pid=94907)</span> Checkpoint successfully created at: Checkpoint(filesystem=local, path=/tmp/ray_results/tune_analyzing_results/train_mnist_6e465_00004_4_lr=0.0081,momentum=0.9000_2023-08-25_17-42-27/checkpoint_000000)
2023-08-25 17:42:30,460	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:30,868	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:31,252	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:31,684	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:32,050	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:32,422	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:32,836	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:33,238	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:33,599	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:33,987	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:34,358	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:34,768	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94905)</span> StorageContext on SESSION (rank=None):<span class=" -Color -Color-Green"> [repeated 8x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/ray-logging.html#log-deduplication for more options.)</span>
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94905)</span> StorageContext&lt;<span class=" -Color -Color-Green"> [repeated 8x across cluster]</span>
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94905)</span>   storage_path=/tmp/ray_results<span class=" -Color -Color-Green"> [repeated 8x across cluster]</span>
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94905)</span>   storage_local_path=/Users/justin/ray_results<span class=" -Color -Color-Green"> [repeated 8x across cluster]</span>
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94905)</span>   storage_filesystem=&lt;pyarrow._fs.LocalFileSystem object at 0x13e75e070&gt;<span class=" -Color -Color-Green"> [repeated 8x across cluster]</span>
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94905)</span>   storage_fs_path=/tmp/ray_results<span class=" -Color -Color-Green"> [repeated 8x across cluster]</span>
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94905)</span>   experiment_dir_name=tune_analyzing_results<span class=" -Color -Color-Green"> [repeated 8x across cluster]</span>
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94905)</span>   current_checkpoint_index=0<span class=" -Color -Color-Green"> [repeated 16x across cluster]</span>
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(ImplicitFunc pid=94905)</span> &gt;<span class=" -Color -Color-Green"> [repeated 8x across cluster]</span>
2023-08-25 17:42:35,127	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
<span class=" -Color -Color-Faint -Color-Faint-Cyan">(train_mnist pid=94906)</span> Checkpoint successfully created at: Checkpoint(filesystem=local, path=/tmp/ray_results/tune_analyzing_results/train_mnist_6e465_00003_3_lr=0.0104,momentum=0.8000_2023-08-25_17-42-27/checkpoint_000050)<span class=" -Color -Color-Green"> [repeated 455x across cluster]</span>
2023-08-25 17:42:35,508	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:35,899	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:36,277	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:36,662	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:37,065	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:37,455	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:37,857	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:38,237	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:38,639	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:39,019	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:39,400	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:39,773	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:39,879	WARNING experiment_state.py:371 -- Experiment checkpoint syncing has been triggered multiple times in the last 30.0 seconds. A sync will be triggered whenever a trial has checkpointed more than `num_to_keep` times since last sync or if 300 seconds have passed since last sync. If you have set `num_to_keep` in your `CheckpointConfig`, consider increasing the checkpoint frequency or keeping more checkpoints. You can supress this warning by changing the `TUNE_WARN_EXCESSIVE_EXPERIMENT_CHECKPOINT_SYNC_THRESHOLD_S` environment variable.
2023-08-25 17:42:39,882	INFO tune.py:1147 -- Total run time: 12.52 seconds (12.42 seconds for the tuning loop).
</pre></div>
</div>
</div>
</div>
<section id="loading-experiment-results-from-an-directory">
<h2>Loading experiment results from an directory<a class="headerlink" href="#loading-experiment-results-from-an-directory" title="Permalink to this headline">#</a></h2>
<p>Although we have the <code class="docutils literal notranslate"><span class="pre">result_grid</span></code> object in memory because we just ran the Tune experiment above, we might be performing this analysis after our initial training script has exited. We can retrieve the <code class="docutils literal notranslate"><span class="pre">ResultGrid</span></code> from a <a class="reference internal" href="../tutorials/tune-stopping.html#tune-stopping-guide"><span class="std std-ref">restored <code class="docutils literal notranslate"><span class="pre">Tuner</span></code></span></a>, passing in the experiment directory, which should look something like <code class="docutils literal notranslate"><span class="pre">~/ray_results/{exp_name}</span></code>. If you don’t specify an experiment <code class="docutils literal notranslate"><span class="pre">name</span></code> in the <code class="docutils literal notranslate"><span class="pre">RunConfig</span></code>, the experiment name will be auto-generated and can be found in the logs of your experiment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">experiment_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">exp_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading results from </span><span class="si">{</span><span class="n">experiment_path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="n">restored_tuner</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">Tuner</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="n">experiment_path</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="n">train_mnist</span><span class="p">)</span>
<span class="n">result_grid</span> <span class="o">=</span> <span class="n">restored_tuner</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading results from /tmp/ray_results/tune_analyzing_results...
</pre></div>
</div>
</div>
</div>
</section>
<section id="experiment-level-analysis-working-with-resultgrid">
<h2>Experiment-level Analysis: Working with <code class="docutils literal notranslate"><span class="pre">ResultGrid</span></code><a class="headerlink" href="#experiment-level-analysis-working-with-resultgrid" title="Permalink to this headline">#</a></h2>
<p>The first thing we might want to check is if there were any erroring trials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check if there have been errors</span>
<span class="k">if</span> <span class="n">result_grid</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;One of the trials failed!&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No errors!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No errors!
</pre></div>
</div>
</div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">ResultGrid</span></code> is an iterable, and we can access its length and index into it to access individual <code class="docutils literal notranslate"><span class="pre">Result</span></code> objects.</p>
<p>We should have <strong>9</strong> results in this example, since we have 3 samples for each of the 3 grid search values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_results</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">result_grid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of results:&quot;</span><span class="p">,</span> <span class="n">num_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of results: 9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Iterate over results</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result_grid</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trial #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> had an error:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">error</span><span class="p">)</span>
        <span class="k">continue</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Trial #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> finished successfully with a mean accuracy metric of:&quot;</span><span class="p">,</span>
        <span class="n">result</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;mean_accuracy&quot;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trial #0 finished successfully with a mean accuracy metric of: 0.953125
Trial #1 finished successfully with a mean accuracy metric of: 0.9625
Trial #2 finished successfully with a mean accuracy metric of: 0.95625
Trial #3 finished successfully with a mean accuracy metric of: 0.946875
Trial #4 finished successfully with a mean accuracy metric of: 0.925
Trial #5 finished successfully with a mean accuracy metric of: 0.934375
Trial #6 finished successfully with a mean accuracy metric of: 0.965625
Trial #7 finished successfully with a mean accuracy metric of: 0.95625
Trial #8 finished successfully with a mean accuracy metric of: 0.94375
</pre></div>
</div>
</div>
</div>
<p>Above, we printed the <strong>last reported</strong> <code class="docutils literal notranslate"><span class="pre">mean_accuracy</span></code> metric for all trials by looping through the <code class="docutils literal notranslate"><span class="pre">result_grid</span></code>.
We can access the same metrics for all trials in a pandas DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_df</span> <span class="o">=</span> <span class="n">result_grid</span><span class="o">.</span><span class="n">get_dataframe</span><span class="p">()</span>
<span class="n">results_df</span><span class="p">[[</span><span class="s2">&quot;training_iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_accuracy&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>training_iteration</th>
      <th>mean_accuracy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100</td>
      <td>0.953125</td>
    </tr>
    <tr>
      <th>1</th>
      <td>100</td>
      <td>0.962500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>100</td>
      <td>0.956250</td>
    </tr>
    <tr>
      <th>3</th>
      <td>100</td>
      <td>0.946875</td>
    </tr>
    <tr>
      <th>4</th>
      <td>100</td>
      <td>0.925000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>100</td>
      <td>0.934375</td>
    </tr>
    <tr>
      <th>6</th>
      <td>100</td>
      <td>0.965625</td>
    </tr>
    <tr>
      <th>7</th>
      <td>100</td>
      <td>0.956250</td>
    </tr>
    <tr>
      <th>8</th>
      <td>100</td>
      <td>0.943750</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shortest training time:&quot;</span><span class="p">,</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;time_total_s&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Longest training time:&quot;</span><span class="p">,</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;time_total_s&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shortest training time: 8.674914598464966
Longest training time: 8.945653676986694
</pre></div>
</div>
</div>
</div>
<p>The last reported metrics might not contain the best accuracy each trial achieved. If we want to get maximum accuracy that each trial reported throughout its training, we can do so by using <code class="xref py py-meth docutils literal notranslate"><span class="pre">ResultGrid.get_dataframe</span></code> specifying a metric and mode used to filter each trial’s training history.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_result_df</span> <span class="o">=</span> <span class="n">result_grid</span><span class="o">.</span><span class="n">get_dataframe</span><span class="p">(</span>
    <span class="n">filter_metric</span><span class="o">=</span><span class="s2">&quot;mean_accuracy&quot;</span><span class="p">,</span> <span class="n">filter_mode</span><span class="o">=</span><span class="s2">&quot;max&quot;</span>
<span class="p">)</span>
<span class="n">best_result_df</span><span class="p">[[</span><span class="s2">&quot;training_iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_accuracy&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>training_iteration</th>
      <th>mean_accuracy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50</td>
      <td>0.968750</td>
    </tr>
    <tr>
      <th>1</th>
      <td>55</td>
      <td>0.975000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>95</td>
      <td>0.975000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>71</td>
      <td>0.978125</td>
    </tr>
    <tr>
      <th>4</th>
      <td>65</td>
      <td>0.959375</td>
    </tr>
    <tr>
      <th>5</th>
      <td>77</td>
      <td>0.965625</td>
    </tr>
    <tr>
      <th>6</th>
      <td>82</td>
      <td>0.975000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>80</td>
      <td>0.968750</td>
    </tr>
    <tr>
      <th>8</th>
      <td>92</td>
      <td>0.975000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="trial-level-analysis-working-with-an-individual-result">
<h2>Trial-level Analysis: Working with an individual <code class="docutils literal notranslate"><span class="pre">Result</span></code><a class="headerlink" href="#trial-level-analysis-working-with-an-individual-result" title="Permalink to this headline">#</a></h2>
<p>Let’s take a look at the result that ended with the best <code class="docutils literal notranslate"><span class="pre">mean_accuracy</span></code> metric. By default, <code class="docutils literal notranslate"><span class="pre">get_best_result</span></code> will use the same metric and mode as defined in the <code class="docutils literal notranslate"><span class="pre">TuneConfig</span></code> above. However, it’s also possible to specify a new metric/order in which results should be ranked.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ray.train</span> <span class="kn">import</span> <span class="n">Result</span>

<span class="c1"># Get the result with the maximum test set `mean_accuracy`</span>
<span class="n">best_result</span><span class="p">:</span> <span class="n">Result</span> <span class="o">=</span> <span class="n">result_grid</span><span class="o">.</span><span class="n">get_best_result</span><span class="p">()</span>

<span class="c1"># Get the result with the minimum `mean_accuracy`</span>
<span class="n">worst_performing_result</span><span class="p">:</span> <span class="n">Result</span> <span class="o">=</span> <span class="n">result_grid</span><span class="o">.</span><span class="n">get_best_result</span><span class="p">(</span>
    <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;mean_accuracy&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;min&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can examine a few of the properties of the best <code class="docutils literal notranslate"><span class="pre">Result</span></code>. See the <a class="reference internal" href="../api/result_grid.html#result-docstring"><span class="std std-ref">API reference</span></a> for a list of all accessible properties.</p>
<p>First, we can access the best result’s hyperparameter configuration with <code class="docutils literal notranslate"><span class="pre">Result.config</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_result</span><span class="o">.</span><span class="n">config</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;lr&#39;: 0.009781335971854077, &#39;momentum&#39;: 0.9, &#39;should_checkpoint&#39;: True}
</pre></div>
</div>
</div>
</div>
<p>Next, we can access the trial directory via <code class="docutils literal notranslate"><span class="pre">Result.path</span></code>. The result <code class="docutils literal notranslate"><span class="pre">path</span></code> gives the trial level directory that contains checkpoints (if you reported any) and logged metrics to load manually or inspect using a tool like Tensorboard (see <code class="docutils literal notranslate"><span class="pre">result.json</span></code>, <code class="docutils literal notranslate"><span class="pre">progress.csv</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_result</span><span class="o">.</span><span class="n">path</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/tmp/ray_results/tune_analyzing_results/train_mnist_6e465_00007_7_lr=0.0098,momentum=0.9000_2023-08-25_17-42-27&#39;
</pre></div>
</div>
</div>
</div>
<p>You can also directly get the latest checkpoint for a specific trial via <code class="docutils literal notranslate"><span class="pre">Result.checkpoint</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the last Checkpoint associated with the best-performing trial</span>
<span class="n">best_result</span><span class="o">.</span><span class="n">checkpoint</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Checkpoint(filesystem=local, path=/tmp/ray_results/tune_analyzing_results/train_mnist_6e465_00007_7_lr=0.0098,momentum=0.9000_2023-08-25_17-42-27/checkpoint_000099)
</pre></div>
</div>
</div>
</div>
<p>You can also get the last-reported metrics associated with a specific trial via <code class="docutils literal notranslate"><span class="pre">Result.metrics</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the last reported set of metrics</span>
<span class="n">best_result</span><span class="o">.</span><span class="n">metrics</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;mean_accuracy&#39;: 0.965625,
 &#39;timestamp&#39;: 1693010559,
 &#39;should_checkpoint&#39;: True,
 &#39;done&#39;: True,
 &#39;training_iteration&#39;: 100,
 &#39;trial_id&#39;: &#39;6e465_00007&#39;,
 &#39;date&#39;: &#39;2023-08-25_17-42-39&#39;,
 &#39;time_this_iter_s&#39;: 0.08028697967529297,
 &#39;time_total_s&#39;: 8.77775764465332,
 &#39;pid&#39;: 94910,
 &#39;node_ip&#39;: &#39;127.0.0.1&#39;,
 &#39;config&#39;: {&#39;lr&#39;: 0.009781335971854077,
  &#39;momentum&#39;: 0.9,
  &#39;should_checkpoint&#39;: True},
 &#39;time_since_restore&#39;: 8.77775764465332,
 &#39;iterations_since_restore&#39;: 100,
 &#39;checkpoint_dir_name&#39;: &#39;checkpoint_000099&#39;,
 &#39;experiment_tag&#39;: &#39;7_lr=0.0098,momentum=0.9000&#39;}
</pre></div>
</div>
</div>
</div>
<p>Access the entire history of reported metrics from a <code class="docutils literal notranslate"><span class="pre">Result</span></code> as a pandas DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_df</span> <span class="o">=</span> <span class="n">best_result</span><span class="o">.</span><span class="n">metrics_dataframe</span>
<span class="n">result_df</span><span class="p">[[</span><span class="s2">&quot;training_iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_accuracy&quot;</span><span class="p">,</span> <span class="s2">&quot;time_total_s&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>training_iteration</th>
      <th>mean_accuracy</th>
      <th>time_total_s</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.168750</td>
      <td>0.111393</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.609375</td>
      <td>0.195086</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.800000</td>
      <td>0.283543</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.840625</td>
      <td>0.388538</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.840625</td>
      <td>0.479402</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>96</td>
      <td>0.946875</td>
      <td>8.415694</td>
    </tr>
    <tr>
      <th>96</th>
      <td>97</td>
      <td>0.943750</td>
      <td>8.524299</td>
    </tr>
    <tr>
      <th>97</th>
      <td>98</td>
      <td>0.956250</td>
      <td>8.606126</td>
    </tr>
    <tr>
      <th>98</th>
      <td>99</td>
      <td>0.934375</td>
      <td>8.697471</td>
    </tr>
    <tr>
      <th>99</th>
      <td>100</td>
      <td>0.965625</td>
      <td>8.777758</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 3 columns</p>
</div></div></div>
</div>
</section>
<section id="plotting-metrics">
<h2>Plotting metrics<a class="headerlink" href="#plotting-metrics" title="Permalink to this headline">#</a></h2>
<p>We can use the metrics DataFrame to quickly visualize learning curves. First, let’s plot the mean accuracy vs. training iterations for the best result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_result</span><span class="o">.</span><span class="n">metrics_dataframe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;training_iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_accuracy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;training_iteration&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/tune_analyze_results_29_1.png" src="../../_images/tune_analyze_results_29_1.png" />
</div>
</div>
<p>We can also iterate through the entire set of results and create a combined plot of all trials with the hyperparameters as labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">result_grid</span><span class="p">:</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;lr=</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;lr&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, momentum=</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;momentum&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">metrics_dataframe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;training_iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_accuracy&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">metrics_dataframe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;training_iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_accuracy&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mean Accuracy vs. Training Iteration for All Trials&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Mean Test Accuracy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Mean Test Accuracy&#39;)
</pre></div>
</div>
<img alt="../../_images/tune_analyze_results_31_1.png" src="../../_images/tune_analyze_results_31_1.png" />
</div>
</div>
</section>
<section id="accessing-checkpoints-and-loading-for-test-inference">
<h2>Accessing checkpoints and loading for test inference<a class="headerlink" href="#accessing-checkpoints-and-loading-for-test-inference" title="Permalink to this headline">#</a></h2>
<p>We saw earlier that <code class="docutils literal notranslate"><span class="pre">Result</span></code> contains the last checkpoint associated with a trial. Let’s see how we can use this checkpoint to load a model for performing inference on some sample MNIST images.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>

<span class="kn">from</span> <span class="nn">ray.tune.examples.mnist_pytorch</span> <span class="kn">import</span> <span class="n">ConvNet</span><span class="p">,</span> <span class="n">get_data_loaders</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ConvNet</span><span class="p">()</span>

<span class="k">with</span> <span class="n">best_result</span><span class="o">.</span><span class="n">checkpoint</span><span class="o">.</span><span class="n">as_directory</span><span class="p">()</span> <span class="k">as</span> <span class="n">checkpoint_dir</span><span class="p">:</span>
    <span class="c1"># The model state dict was saved under `model.pt` by the training function</span>
    <span class="c1"># imported from `ray.tune.examples.mnist_pytorch`</span>
    <span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">&quot;model.pt&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>Refer to the training loop definition <a class="reference internal" href="includes/mnist_pytorch.html"><span class="doc">here</span></a> to see how we are saving the checkpoint in the first place.</p>
<p>Next, let’s test our model with a sample data point and print out the predicted class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">_</span><span class="p">,</span> <span class="n">test_loader</span> <span class="o">=</span> <span class="n">get_data_loaders</span><span class="p">()</span>
<span class="n">test_img</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">test_loader</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="n">predicted_class</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">test_img</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted Class =&quot;</span><span class="p">,</span> <span class="n">predicted_class</span><span class="p">)</span>

<span class="c1"># Need to reshape to (batch_size, channels, width, height)</span>
<span class="n">test_img</span> <span class="o">=</span> <span class="n">test_img</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">test_img</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Predicted Class = 9
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x31ddd2fd0&gt;
</pre></div>
</div>
<img alt="../../_images/tune_analyze_results_35_2.png" src="../../_images/tune_analyze_results_35_2.png" />
</div>
</div>
<p>Consider using Ray Data if you want to use a checkpointed model for large scale inference!</p>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>In this guide, we looked at some common analysis workflows you can perform using the <code class="docutils literal notranslate"><span class="pre">ResultGrid</span></code> output returned by <code class="docutils literal notranslate"><span class="pre">Tuner.fit</span></code>. These included: <strong>loading results from an experiment directory, exploring experiment-level and trial-level results, plotting logged metrics, and accessing trial checkpoints for inference.</strong></p>
<p>Take a look at <a class="reference internal" href="index.html#tune-experiment-tracking-examples"><span class="std std-ref">Tune’s experiment tracking integrations</span></a> for more analysis tools that you can build into your Tune experiment with a few callbacks!</p>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../tutorials/tune_get_data_in_and_out.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Getting Data in and out of Tune</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="pbt_guide.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">A Guide to Population Based Training with Tune</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><!-- Override the footer area for the sphinx-book-theme to include the CSAT widget -->
<div id="csat">
  <div id="csat-feedback-received" class="csat-hidden">
    <span>谢谢你的反馈！</span>
  </div>
  <div id="csat-inputs">
    <span>是否能帮助到你？</span>
    <div id="csat-yes" class="csat-button">
      <svg id="csat-yes-icon" class="csat-hidden csat-icon" width="18" height="13" viewBox="0 0 18 13" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.00023 10.172L16.1922 0.979004L17.6072 2.393L7.00023 13L0.63623 6.636L2.05023 5.222L7.00023 10.172Z" fill="black"/>
      </svg>
      <span>是<span>
    </div>
    <div id="csat-no" class="csat-button">
      <svg id="csat-no-icon" class="csat-hidden csat-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.00023 5.58599L11.9502 0.635986L13.3642 2.04999L8.41423 6.99999L13.3642 11.95L11.9502 13.364L7.00023 8.41399L2.05023 13.364L0.63623 11.95L5.58623 6.99999L0.63623 2.04999L2.05023 0.635986L7.00023 5.58599Z" fill="black"/>
      </svg>
      <span>否<span>
    </div>
  </div>
  <div id="csat-textarea-group" class="csat-hidden">
    <span id="csat-feedback-label">反馈</span>
    <textarea id="csat-textarea"></textarea>
    <div id="csat-submit">提交</div>
  </div>
</div><p>
  
    By The Ray Team<br/>
  
      &copy; Copyright 2024, The Ray Team.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>